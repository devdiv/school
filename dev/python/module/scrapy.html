<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.32">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"><link rel="icon" href="images/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#ffffff"><meta name="google-site-verification"><title>Scrapy网络数据处理框架 | School</title><meta name="description" content="不抛弃，不放弃">
    <link rel="modulepreload" href="/school/assets/app.a770902d.js"><link rel="modulepreload" href="/school/assets/scrapy.html.11046d29.js"><link rel="modulepreload" href="/school/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/school/assets/scrapy.html.ea716027.js">
    <link rel="stylesheet" href="/school/assets/style.b355fc9d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/school/" class=""><img class="logo" src="/school/images/hero.png" alt="School"><span class="site-name can-hide">School</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/school/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络"><span class="title">网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络"><span class="title">网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>数据通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/dc/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/dc/trans/" class="" aria-label="数据传输"><!--[--><!--]--> 数据传输 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>TCP/IP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/netlayer/" class="" aria-label="网络层"><!--[--><!--]--> 网络层 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/translayer/" class="" aria-label="传输层"><!--[--><!--]--> 传输层 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络技术</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tech/lan/" class="" aria-label="局域网"><!--[--><!--]--> 局域网 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tech/eth/" class="" aria-label="以太网交换技术"><!--[--><!--]--> 以太网交换技术 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络安全</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/sec/firewall/" class="" aria-label="防火墙"><!--[--><!--]--> 防火墙 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="研发"><span class="title">研发</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="研发"><span class="title">研发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/python/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/python/module/" class="router-link-active" aria-label="模块"><!--[--><!--]--> 模块 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>测试</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="Vuetify"><!--[--><!--]--> Vuetify <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="管理"><span class="title">管理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="管理"><span class="title">管理</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="过程组"><!--[--><!--]--> 过程组 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="知识域"><!--[--><!--]--> 知识域 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具"><span class="title">工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具"><span class="title">工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/net/netwox/" class="" aria-label="NetWox"><!--[--><!--]--> NetWox <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/net/wireshark/" class="" aria-label="WireShark"><!--[--><!--]--> WireShark <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>研发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/git/" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/yum/" class="" aria-label="Yum"><!--[--><!--]--> Yum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/github/" class="" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/vscode/" class="" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="更多"><span class="title">更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="更多"><span class="title">更多</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/school/more/website.html" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/school/more/reading/" class="" aria-label="读书"><!--[--><!--]--> 读书 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/school/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络"><span class="title">网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络"><span class="title">网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>数据通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/dc/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/dc/trans/" class="" aria-label="数据传输"><!--[--><!--]--> 数据传输 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>TCP/IP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/netlayer/" class="" aria-label="网络层"><!--[--><!--]--> 网络层 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/translayer/" class="" aria-label="传输层"><!--[--><!--]--> 传输层 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络技术</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tech/lan/" class="" aria-label="局域网"><!--[--><!--]--> 局域网 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tech/eth/" class="" aria-label="以太网交换技术"><!--[--><!--]--> 以太网交换技术 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络安全</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/sec/firewall/" class="" aria-label="防火墙"><!--[--><!--]--> 防火墙 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="研发"><span class="title">研发</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="研发"><span class="title">研发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/python/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/python/module/" class="router-link-active" aria-label="模块"><!--[--><!--]--> 模块 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>测试</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="Vuetify"><!--[--><!--]--> Vuetify <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="管理"><span class="title">管理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="管理"><span class="title">管理</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="过程组"><!--[--><!--]--> 过程组 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="知识域"><!--[--><!--]--> 知识域 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具"><span class="title">工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具"><span class="title">工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/net/netwox/" class="" aria-label="NetWox"><!--[--><!--]--> NetWox <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/net/wireshark/" class="" aria-label="WireShark"><!--[--><!--]--> WireShark <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>研发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/git/" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/yum/" class="" aria-label="Yum"><!--[--><!--]--> Yum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/github/" class="" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/vscode/" class="" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="更多"><span class="title">更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="更多"><span class="title">更多</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/school/more/website.html" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/school/more/reading/" class="" aria-label="读书"><!--[--><!--]--> 读书 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading active">MODULE <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/school/dev/python/module/" class="router-link-active sidebar-item" aria-label="Python 模块"><!--[--><!--]--> Python 模块 <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/builtin.html" class="sidebar-item" aria-label="常用内建模块"><!--[--><!--]--> 常用内建模块 <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/impacket.html" class="sidebar-item" aria-label="Impacket"><!--[--><!--]--> Impacket <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/paramiko.html" class="sidebar-item" aria-label="Paramiko"><!--[--><!--]--> Paramiko <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/pyshark.html" class="sidebar-item" aria-label="pyshark网络数据包解析"><!--[--><!--]--> pyshark网络数据包解析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Scrapy网络数据处理框架"><!--[--><!--]--> Scrapy网络数据处理框架 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用"><!--[--><!--]--> 使用 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#stacking-layers" class="router-link-active router-link-exact-active sidebar-item" aria-label="Stacking layers"><!--[--><!--]--> Stacking layers <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#reading-pcap-files" class="router-link-active router-link-exact-active sidebar-item" aria-label="Reading PCAP files"><!--[--><!--]--> Reading PCAP files <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#graphical-dumps-pdf-ps" class="router-link-active router-link-exact-active sidebar-item" aria-label="Graphical dumps (PDF, PS)"><!--[--><!--]--> Graphical dumps (PDF, PS) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#sniffing" class="router-link-active router-link-exact-active sidebar-item" aria-label="Sniffing"><!--[--><!--]--> Sniffing <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#matplotlib" class="router-link-active router-link-exact-active sidebar-item" aria-label="Matplotlib"><!--[--><!--]--> Matplotlib <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/scrapy.html#tcp-traceroute" class="router-link-active router-link-exact-active sidebar-item" aria-label="TCP traceroute"><!--[--><!--]--> TCP traceroute <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a href="/school/dev/python/module/subprocess.html" class="sidebar-item" aria-label="subprocess"><!--[--><!--]--> subprocess <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/virtualenv.html" class="sidebar-item" aria-label="virtualenv"><!--[--><!--]--> virtualenv <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="scrapy网络数据处理框架" tabindex="-1"><a class="header-anchor" href="#scrapy网络数据处理框架" aria-hidden="true">#</a> Scrapy网络数据处理框架</h1><p>Scapy 是一个 Python 程序，它使用户能够发送、嗅探、剖析和伪造网络数据包。 此功能允许构建可以探测、扫描或攻击网络的工具。</p><p>换句话说，Scapy 是一个强大的交互式数据包操作程序。 它能够伪造或解码多种协议的数据包，通过网络发送它们，捕获它们，匹配请求和回复等等。 Scapy 可以轻松处理大多数经典任务，例如扫描、跟踪路由、探测、单元测试、攻击或网络发现。 它可以替代 hping、arpspoof、arp-sk、arping、p0f 甚至 Nmap、tcpdump 和 tshark 的某些部分。</p><p><img src="/school/assets/scapy-1.8361555a.png" alt="image"></p><p>Scapy 在大多数其他工具无法处理的许多其他特定任务上也表现出色，例如发送无效帧、注入您自己的 802.11 帧、组合技术（VLAN 跳跃 + ARP 缓存中毒、WEP 加密通道上的 VOIP 解码，...... ）， 等等。</p><p>这个想法很简单。 Scapy 主要做两件事：发送数据包和接收答案。 您定义一组数据包，它发送它们，接收答案，将请求与答案匹配并返回数据包对（请求，答案）列表和未匹配数据包列表。 与 Nmap 或 hping 等工具相比，这具有很大的优势，即答案不会简化为（打开/关闭/过滤），而是整个数据包。</p><p>在此之上可以构建更多高级功能，例如，执行跟踪路由并因此仅给出请求的起始 TTL 和答案的源 IP 的功能。 一个可以 ping 整个网络并给出应答的机器列表。 一个执行端口扫描并返回 LaTeX 报告的程序。</p><table><thead><tr><th>项目</th><th>描述</th></tr></thead><tbody><tr><td>官方文档</td><td><a href="https://scapy.net/" target="_blank" rel="noopener noreferrer">https://scapy.net/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a></td></tr><tr><td>GitHub</td><td><a href="https://github.com/secdev/scapy" target="_blank" rel="noopener noreferrer">https://github.com/secdev/scapy<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a></td></tr></tbody></table><h2 id="使用" tabindex="-1"><a class="header-anchor" href="#使用" aria-hidden="true">#</a> 使用</h2><h3 id="stacking-layers" tabindex="-1"><a class="header-anchor" href="#stacking-layers" aria-hidden="true">#</a> Stacking layers</h3><p>/ 运算符已用作两层之间的组合运算符。 这样做时，下层可以根据上层重载一个或多个默认字段。 （你仍然可以给出你想要的值）。 字符串可以用作原始层。</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP <span class="token operator">|</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Ether <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">&quot;GET / HTTP/1.0\r\n\r\n&quot;</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET / HTTP/1.0\r\n\r\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>UDP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Ether <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>IP <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>UDP <span class="token operator">|</span><span class="token operator">&lt;</span>UDP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span>proto<span class="token operator">=</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span><span class="token number">55</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><p><img src="/school/assets/scapy-2.a581282c.png" alt="image"></p><p>可以构建或剖析每个数据包（注意：在 Python 中 _（下划线）是最新结果）</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>raw<span class="token punctuation">(</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token string">&#39;E\x00\x00\x14\x00\x01\x00\x00@\x00|\xe7\x7f\x00\x00\x01\x7f\x00\x00\x01&#39;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span>_<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">20</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span> flags<span class="token operator">=</span> frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>IP
 chksum<span class="token operator">=</span><span class="token number">0x7ce7</span> src<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> dst<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">|</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span>dst<span class="token operator">=</span><span class="token string">&quot;www.slashdot.org&quot;</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">&quot;GET /index.html HTTP/1.0 \n\n&quot;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>hexdump<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token number">00</span> <span class="token number">02</span> <span class="token number">15</span> <span class="token number">37</span> A2 <span class="token number">44</span> <span class="token number">00</span> AE F3 <span class="token number">52</span> AA D1 <span class="token number">08</span> <span class="token number">00</span> <span class="token number">45</span> <span class="token number">00</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">.7</span><span class="token punctuation">.</span>D<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>R<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>E<span class="token punctuation">.</span>
<span class="token number">00</span> <span class="token number">43</span> <span class="token number">00</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">40</span> <span class="token number">06</span> <span class="token number">78</span> 3C C0 A8 <span class="token number">05</span> <span class="token number">15</span> <span class="token number">42</span> <span class="token number">23</span>  <span class="token punctuation">.</span>C<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>@<span class="token punctuation">.</span>x<span class="token operator">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>B<span class="token comment">#</span>
FA <span class="token number">97</span> <span class="token number">00</span> <span class="token number">14</span> <span class="token number">00</span> <span class="token number">50</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">50</span> <span class="token number">02</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>P<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>P<span class="token punctuation">.</span>
<span class="token number">20</span> <span class="token number">00</span> BB <span class="token number">39</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">47</span> <span class="token number">45</span> <span class="token number">54</span> <span class="token number">20</span> 2F <span class="token number">69</span> 6E <span class="token number">64</span> <span class="token number">65</span> <span class="token number">78</span>   <span class="token punctuation">.</span><span class="token number">.9</span><span class="token punctuation">.</span><span class="token punctuation">.</span>GET <span class="token operator">/</span>index
2E <span class="token number">68</span> <span class="token number">74</span> 6D 6C <span class="token number">20</span> <span class="token number">48</span> <span class="token number">54</span> <span class="token number">54</span> <span class="token number">50</span> 2F <span class="token number">31</span> 2E <span class="token number">30</span> <span class="token number">20</span> 0A  <span class="token punctuation">.</span>html HTTP<span class="token operator">/</span><span class="token number">1.0</span> <span class="token punctuation">.</span>
0A                                               <span class="token punctuation">.</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b<span class="token operator">=</span>raw<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b
&#39;\x00\x02\x157\xa2D\x00\xae\xf3R\xaa\xd1\x08\x00E\x00\x00C\x00\x01\x00\x00@\x06x<span class="token operator">&lt;</span>\xc0
 \xa8\x05\x15B<span class="token comment">#\xfa\x97\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P\x02 \x00</span>
 \xbb9\x00\x00GET <span class="token operator">/</span>index<span class="token punctuation">.</span>html HTTP<span class="token operator">/</span><span class="token number">1.0</span> \n\n&#39;
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c<span class="token operator">=</span>Ether<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span> src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">67</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span> flags<span class="token operator">=</span> frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0x783c</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP sport<span class="token operator">=</span><span class="token number">20</span> dport<span class="token operator">=</span><span class="token number">80</span> seq<span class="token operator">=</span>0L
 ack<span class="token operator">=</span>0L dataofs<span class="token operator">=</span>5L reserved<span class="token operator">=</span>0L flags<span class="token operator">=</span>S window<span class="token operator">=</span><span class="token number">8192</span> chksum<span class="token operator">=</span><span class="token number">0xbb39</span> urgptr<span class="token operator">=</span><span class="token number">0</span>
 options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET /index.html HTTP/1.0 \n\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><p>如果这太冗长，方法 hide_defaults() 将删除与默认值具有相同值的每个字段：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c<span class="token punctuation">.</span>hide_defaults<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>0f<span class="token punctuation">:</span><span class="token number">66</span><span class="token punctuation">:</span><span class="token number">56</span><span class="token punctuation">:</span>fa<span class="token punctuation">:</span>d2 src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP ihl<span class="token operator">=</span>5L <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">67</span>
 frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0x783c</span> src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP dataofs<span class="token operator">=</span>5L
 chksum<span class="token operator">=</span><span class="token number">0xbb39</span> options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET /index.html HTTP/1.0 \n\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><h3 id="reading-pcap-files" tabindex="-1"><a class="header-anchor" href="#reading-pcap-files" aria-hidden="true">#</a> Reading PCAP files</h3><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>rdpcap<span class="token punctuation">(</span><span class="token string">&quot;/spare/captures/isakmp.cap&quot;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a
<span class="token operator">&lt;</span>isakmp<span class="token punctuation">.</span>cap<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">721</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">0</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="graphical-dumps-pdf-ps" tabindex="-1"><a class="header-anchor" href="#graphical-dumps-pdf-ps" aria-hidden="true">#</a> Graphical dumps (PDF, PS)</h3><p>如果您安装了 PyX，您可以制作一个数据包或数据包列表的图形 PostScript/PDF 转储（参见下面丑陋的 PNG 图像。PostScript/PDF 质量要好得多……）：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">[</span><span class="token number">423</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pdfdump<span class="token punctuation">(</span>layer_shift<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">[</span><span class="token number">423</span><span class="token punctuation">]</span><span class="token punctuation">.</span>psdump<span class="token punctuation">(</span><span class="token string">&quot;/tmp/isakmp_pkt.eps&quot;</span><span class="token punctuation">,</span>layer_shift<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/school/assets/scapy-3.73790c8c.png" alt="image"></p><h3 id="sniffing" tabindex="-1"><a class="header-anchor" href="#sniffing" aria-hidden="true">#</a> Sniffing</h3><p>我们可以轻松捕获一些数据包，甚至可以克隆 tcpdump 或 tshark。 可以提供一个接口或要嗅探的接口列表。 如果没有给出接口，则会在 <code>conf.iface</code> 上进行嗅探：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token operator">=</span><span class="token string">&quot;icmp and host 66.35.250.151&quot;</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Sniffed<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">2</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>_
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">.</span>nsummary<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">0000</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token number">0001</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
 a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">84</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">0</span> flags<span class="token operator">=</span>DF frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>ICMP chksum<span class="token operator">=</span><span class="token number">0x3831</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>ICMP <span class="token builtin">type</span><span class="token operator">=</span>echo<span class="token operator">-</span>request code<span class="token operator">=</span><span class="token number">0</span>
 chksum<span class="token operator">=</span><span class="token number">0x6571</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">0x8745</span> seq<span class="token operator">=</span><span class="token number">0x0</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span>&#39;B\xf7g\xda\x00\x07um\x08\t\n\x0b
 \x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d
 \x1e\x1f !\x22<span class="token comment">#$%&amp;\&#39;()*+,-./01234567&#39; |&gt;&gt;&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">&quot;wifi0&quot;</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">5</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Probe Response <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">:</span>d6<span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">:</span>3f <span class="token operator">/</span> <span class="token number">802.11</span> Authentication
<span class="token number">802.11</span> Management <span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Authentication
<span class="token number">802.11</span> Management <span class="token number">0</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">:</span>d6<span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">:</span>3f <span class="token operator">/</span> <span class="token number">802.11</span> Association Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info <span class="token number">133</span> <span class="token operator">/</span> Info <span class="token number">149</span>
<span class="token number">802.11</span> Management <span class="token number">1</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Association Response <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info <span class="token number">133</span> <span class="token operator">/</span> Info <span class="token number">149</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> ARP who has <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.172</span> says <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.171</span> <span class="token operator">/</span> Padding
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> ARP <span class="token keyword">is</span> at <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span>b7<span class="token punctuation">:</span>4b<span class="token punctuation">:</span>9c<span class="token punctuation">:</span>dd says <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.172</span> <span class="token operator">/</span> Padding
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">&quot;eth1&quot;</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Ethernet <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
dst       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1
src       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span>
<span class="token builtin">type</span>      <span class="token operator">=</span> <span class="token number">0x800</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> IP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
   version   <span class="token operator">=</span> 4L
   ihl       <span class="token operator">=</span> 5L
   tos       <span class="token operator">=</span> <span class="token number">0x0</span>
   <span class="token builtin">len</span>       <span class="token operator">=</span> <span class="token number">84</span>
   <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0</span>
   flags     <span class="token operator">=</span> DF
   frag      <span class="token operator">=</span> 0L
   ttl       <span class="token operator">=</span> <span class="token number">64</span>
   proto     <span class="token operator">=</span> ICMP
   chksum    <span class="token operator">=</span> <span class="token number">0x3831</span>
   src       <span class="token operator">=</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span>
   dst       <span class="token operator">=</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span>
   options   <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> ICMP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
      <span class="token builtin">type</span>      <span class="token operator">=</span> echo<span class="token operator">-</span>request
      code      <span class="token operator">=</span> <span class="token number">0</span>
      chksum    <span class="token operator">=</span> <span class="token number">0x89d9</span>
      <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0xc245</span>
      seq       <span class="token operator">=</span> <span class="token number">0x0</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Raw <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
         load      <span class="token operator">=</span> <span class="token string">&#39;B\xf7i\xa9\x00\x04\x149\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\x22#$%&amp;\&#39;()*+,-./01234567&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Ethernet <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
dst       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span>
src       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1
<span class="token builtin">type</span>      <span class="token operator">=</span> <span class="token number">0x800</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> IP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
   version   <span class="token operator">=</span> 4L
   ihl       <span class="token operator">=</span> 5L
   tos       <span class="token operator">=</span> <span class="token number">0x0</span>
   <span class="token builtin">len</span>       <span class="token operator">=</span> <span class="token number">84</span>
   <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">2070</span>
   flags     <span class="token operator">=</span>
   frag      <span class="token operator">=</span> 0L
   ttl       <span class="token operator">=</span> <span class="token number">42</span>
   proto     <span class="token operator">=</span> ICMP
   chksum    <span class="token operator">=</span> <span class="token number">0x861b</span>
   src       <span class="token operator">=</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span>
   dst       <span class="token operator">=</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span>
   options   <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> ICMP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
      <span class="token builtin">type</span>      <span class="token operator">=</span> echo<span class="token operator">-</span>reply
      code      <span class="token operator">=</span> <span class="token number">0</span>
      chksum    <span class="token operator">=</span> <span class="token number">0x91d9</span>
      <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0xc245</span>
      seq       <span class="token operator">=</span> <span class="token number">0x0</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Raw <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
         load      <span class="token operator">=</span> <span class="token string">&#39;B\xf7i\xa9\x00\x04\x149\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\x22#$%&amp;\&#39;()*+,-./01234567&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Padding <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
            load      <span class="token operator">=</span> <span class="token string">&#39;\n_\x00\x0b&#39;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;eth1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;eth2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>sniffed_on<span class="token operator">+</span><span class="token string">&quot;: &quot;</span><span class="token operator">+</span>x<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
eth3<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> <span class="token operator">&gt;</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
eth3<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
eth2<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.22</span> <span class="token operator">&gt;</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.152</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
eth2<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.152</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.22</span> echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
</code></pre></div><p>为了更好地控制显示的信息，我们可以使用 <code>sprintf()</code> 函数：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pkts <span class="token operator">=</span> sniff<span class="token punctuation">(</span>prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">.</span>sprintf<span class="token punctuation">(</span><span class="token string">&quot;{IP:%IP.src% -&gt; %IP.dst%\n}{Raw:%Raw.load%\n}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>

<span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span>

<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>

<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>
&#39;GET <span class="token operator">/</span> HTTP<span class="token operator">/</span><span class="token number">1.1</span>\r\nHost<span class="token punctuation">:</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>\r\nUser<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span>
<span class="token punctuation">(</span>X11<span class="token punctuation">;</span> U<span class="token punctuation">;</span> Linux i686<span class="token punctuation">;</span> en<span class="token operator">-</span>US<span class="token punctuation">;</span> rv<span class="token punctuation">:</span><span class="token number">1.8</span><span class="token number">.1</span><span class="token number">.8</span><span class="token punctuation">)</span> Gecko<span class="token operator">/</span><span class="token number">20071022</span> Ubuntu<span class="token operator">/</span><span class="token number">7.10</span> <span class="token punctuation">(</span>gutsy<span class="token punctuation">)</span>
Firefox<span class="token operator">/</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token number">.8</span>\r\nAccept<span class="token punctuation">:</span> text<span class="token operator">/</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>
text<span class="token operator">/</span>html<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>text<span class="token operator">/</span>plain<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>image<span class="token operator">/</span>png<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.5</span>\r\nAccept<span class="token operator">-</span>Language<span class="token punctuation">:</span>
en<span class="token operator">-</span>us<span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.5</span>\r\nAccept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span>deflate\r\nAccept<span class="token operator">-</span>Charset<span class="token punctuation">:</span>
ISO<span class="token operator">-</span><span class="token number">8859</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span>\r\nKeep<span class="token operator">-</span>Alive<span class="token punctuation">:</span> <span class="token number">300</span>\r\nConnection<span class="token punctuation">:</span>
keep<span class="token operator">-</span>alive\r\nCache<span class="token operator">-</span>Control<span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>\r\n\r\n&#39;
</code></pre></div><p>我们可以嗅探并进行被动操作系统指纹识别：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span>4b<span class="token punctuation">:</span>b3<span class="token punctuation">:</span>7d<span class="token punctuation">:</span>4e src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">:</span>7b<span class="token punctuation">:</span><span class="token number">60</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">60</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">61681</span> flags<span class="token operator">=</span>DF frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0xb85e</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.10</span> dst<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP sport<span class="token operator">=</span><span class="token number">46511</span> dport<span class="token operator">=</span><span class="token number">80</span>
 seq<span class="token operator">=</span>2023566040L ack<span class="token operator">=</span>0L dataofs<span class="token operator">=</span>10L reserved<span class="token operator">=</span>0L flags<span class="token operator">=</span>SEC window<span class="token operator">=</span><span class="token number">5840</span>
 chksum<span class="token operator">=</span><span class="token number">0x570c</span> urgptr<span class="token operator">=</span><span class="token number">0</span> options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;Timestamp&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>342940201L<span class="token punctuation">,</span> 0L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;MSS&#39;</span><span class="token punctuation">,</span> <span class="token number">1460</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">&#39;NOP&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;SAckOK&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;WScale&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>load_module<span class="token punctuation">(</span><span class="token string">&quot;p0f&quot;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p0f<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>sniff<span class="token punctuation">(</span>prn<span class="token operator">=</span>prnp0f<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">0.875</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Linux 2.4.10 (1)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Windows 98 (?)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Windows 2000 (9)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="matplotlib" tabindex="-1"><a class="header-anchor" href="#matplotlib" aria-hidden="true">#</a> Matplotlib</h3><p>222 / 5,000 翻译结果 我们可以使用 Matplotlib 轻松绘制一些有效的值。 （确保您安装了 matplotlib）例如，我们可以观察 IP ID 模式以了解负载均衡器后面使用了多少不同的 IP 堆栈：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">,</span> b <span class="token operator">=</span> sr<span class="token punctuation">(</span>IP<span class="token punctuation">(</span>dst<span class="token operator">=</span><span class="token string">&quot;www.target.com&quot;</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span>sport<span class="token operator">=</span><span class="token punctuation">[</span>RandShort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>matplotlib<span class="token punctuation">.</span>lines<span class="token punctuation">.</span>Line2D at <span class="token number">0x2367b80d6a0</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><p><img src="/school/assets/scapy-4.e1ea96b9.png" alt="image"></p><h3 id="tcp-traceroute" tabindex="-1"><a class="header-anchor" href="#tcp-traceroute" aria-hidden="true">#</a> TCP traceroute</h3><p>Scapy 还具有强大的 TCP traceroute 功能。 与其他 traceroute 程序在进入下一个节点之前等待每个节点回复不同，Scapy 同时发送所有数据包。 这样做的缺点是不知道什么时候停止（因此是 maxttl 参数），但最大的优点是不到 3 秒就可以得到这个多目标 traceroute 结果：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.yahoo.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.altavista.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.wisenut.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.copernic.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
Received <span class="token number">80</span> packets<span class="token punctuation">,</span> got <span class="token number">80</span> answers<span class="token punctuation">,</span> remaining <span class="token number">0</span> packets
   <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>
<span class="token number">6</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">213.228</span><span class="token number">.3</span><span class="token number">.234</span>      <span class="token number">193.251</span><span class="token number">.251</span><span class="token number">.69</span>
<span class="token number">7</span>  <span class="token number">213.248</span><span class="token number">.71</span><span class="token number">.141</span>     <span class="token number">217.118</span><span class="token number">.239</span><span class="token number">.149</span>    <span class="token number">208.184</span><span class="token number">.231</span><span class="token number">.214</span>    <span class="token number">193.251</span><span class="token number">.241</span><span class="token number">.178</span>
<span class="token number">8</span>  <span class="token number">213.248</span><span class="token number">.65</span><span class="token number">.81</span>      <span class="token number">217.118</span><span class="token number">.224</span><span class="token number">.44</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.129</span>      <span class="token number">193.251</span><span class="token number">.242</span><span class="token number">.98</span>
<span class="token number">9</span>  <span class="token number">213.248</span><span class="token number">.70</span><span class="token number">.14</span>      <span class="token number">213.206</span><span class="token number">.129</span><span class="token number">.85</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.186</span>      <span class="token number">193.251</span><span class="token number">.243</span><span class="token number">.89</span>
<span class="token number">10</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">213.206</span><span class="token number">.128</span><span class="token number">.160</span>    <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.122</span>      <span class="token number">193.251</span><span class="token number">.254</span><span class="token number">.126</span>
<span class="token number">11</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.169</span><span class="token number">.41</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.70</span>       <span class="token number">216.115</span><span class="token number">.97</span><span class="token number">.178</span>
<span class="token number">12</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.226</span><span class="token number">.99</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.209</span>      <span class="token number">66.218</span><span class="token number">.64</span><span class="token number">.146</span>
<span class="token number">13</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.227</span><span class="token number">.106</span>     <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.45</span>       <span class="token number">66.218</span><span class="token number">.82</span><span class="token number">.230</span>
<span class="token number">14</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.74</span><span class="token number">.30</span>      <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.214</span>      <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">15</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.120</span><span class="token number">.149</span>    <span class="token number">64.124</span><span class="token number">.229</span><span class="token number">.109</span>     <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">16</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">17</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">18</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">19</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">20</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token punctuation">(</span><span class="token operator">&lt;</span>Traceroute<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">28</span> ICMP<span class="token punctuation">:</span><span class="token number">52</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>Unanswered<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">0</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><p>最后一行实际上是函数的结果：traceroute 结果对象和未应答数据包的数据包列表。 traceroute 结果是经典结果对象的更专业化的版本（实际上是一个子类）。 我们可以保存它以稍后再次查询 traceroute 结果，或者深入检查其中一个答案，例如检查填充。</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">,</span> unans <span class="token operator">=</span> _
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> Padding <span class="token keyword">in</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>像任何结果对象一样，可以添加 traceroute 对象：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r2<span class="token punctuation">,</span> unans <span class="token operator">=</span> traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.voila.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
Received <span class="token number">19</span> packets<span class="token punctuation">,</span> got <span class="token number">19</span> answers<span class="token punctuation">,</span> remaining <span class="token number">1</span> packets
   <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>
<span class="token number">6</span>  <span class="token number">193.252</span><span class="token number">.161</span><span class="token number">.97</span>
<span class="token number">7</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.86</span>
<span class="token number">8</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.77</span>
<span class="token number">9</span>  <span class="token number">193.252</span><span class="token number">.101</span><span class="token number">.1</span>
<span class="token number">10</span> <span class="token number">193.252</span><span class="token number">.227</span><span class="token number">.245</span>
<span class="token number">12</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">13</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">14</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">15</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">16</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">17</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">18</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">19</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">20</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r3<span class="token operator">=</span>result<span class="token operator">+</span>r2
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r3<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>   <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token operator">-</span>                  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>
<span class="token number">6</span>  <span class="token number">193.252</span><span class="token number">.161</span><span class="token number">.97</span>     <span class="token number">194.68</span><span class="token number">.129</span><span class="token number">.168</span>     <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">213.228</span><span class="token number">.3</span><span class="token number">.234</span>      <span class="token number">193.251</span><span class="token number">.251</span><span class="token number">.69</span>
<span class="token number">7</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.86</span>     <span class="token number">212.23</span><span class="token number">.42</span><span class="token number">.33</span>       <span class="token number">217.118</span><span class="token number">.239</span><span class="token number">.185</span>    <span class="token number">208.184</span><span class="token number">.231</span><span class="token number">.214</span>    <span class="token number">193.251</span><span class="token number">.241</span><span class="token number">.178</span>
<span class="token number">8</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.77</span>     <span class="token number">212.23</span><span class="token number">.42</span><span class="token number">.6</span>        <span class="token number">217.118</span><span class="token number">.224</span><span class="token number">.44</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.129</span>      <span class="token number">193.251</span><span class="token number">.242</span><span class="token number">.98</span>
<span class="token number">9</span>  <span class="token number">193.252</span><span class="token number">.101</span><span class="token number">.1</span>      <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">213.206</span><span class="token number">.129</span><span class="token number">.85</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.186</span>      <span class="token number">193.251</span><span class="token number">.243</span><span class="token number">.89</span>
<span class="token number">10</span> <span class="token number">193.252</span><span class="token number">.227</span><span class="token number">.245</span>    <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">213.206</span><span class="token number">.128</span><span class="token number">.160</span>    <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.122</span>      <span class="token number">193.251</span><span class="token number">.254</span><span class="token number">.126</span>
<span class="token number">11</span> <span class="token operator">-</span>                  <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.169</span><span class="token number">.41</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.70</span>       <span class="token number">216.115</span><span class="token number">.97</span><span class="token number">.178</span>
<span class="token number">12</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.226</span><span class="token number">.100</span>     <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.209</span>      <span class="token number">216.115</span><span class="token number">.101</span><span class="token number">.46</span>
<span class="token number">13</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.238</span><span class="token number">.166</span>     <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.45</span>       <span class="token number">66.218</span><span class="token number">.82</span><span class="token number">.234</span>
<span class="token number">14</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.74</span><span class="token number">.30</span>      <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.214</span>      <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">15</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.120</span><span class="token number">.151</span>    <span class="token number">64.124</span><span class="token number">.229</span><span class="token number">.109</span>     <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">16</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">17</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">18</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">19</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">20</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
</code></pre></div><p>Traceroute 结果对象还有一个非常巧妙的特性：它们可以将得到的所有路由制作成有向图，并通过 AS（自治系统）进行聚类。 您将需要graphviz。 默认情况下，ImageMagick 用于显示图形。</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">,</span> unans <span class="token operator">=</span> traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.microsoft.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.cisco.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.yahoo.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.wanadoo.fr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.pacsec.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dport<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">443</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>retry<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
Received <span class="token number">190</span> packets<span class="token punctuation">,</span> got <span class="token number">190</span> answers<span class="token punctuation">,</span> remaining <span class="token number">10</span> packets
   <span class="token number">193.252</span><span class="token number">.122</span><span class="token number">.103</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token number">193.252</span><span class="token number">.122</span><span class="token number">.103</span><span class="token punctuation">:</span><span class="token number">80</span> <span class="token number">198.133</span><span class="token number">.219</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token number">198.133</span><span class="token number">.219</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">207.46</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>         <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.16</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>        <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.22</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span><span class="token punctuation">)</span>                          <span class="token comment"># piped to ImageMagick&#39;s display program. Image below.</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;ps&quot;</span><span class="token punctuation">,</span>target<span class="token operator">=</span><span class="token string">&quot;| lp&quot;</span><span class="token punctuation">)</span>   <span class="token comment"># piped to postscript printer</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token string">&quot;&gt; /tmp/graph.svg&quot;</span><span class="token punctuation">)</span> <span class="token comment"># saved to file</span>
</code></pre></div><p><img src="/school/assets/scapy-5.13a6ba10.png" alt="image"></p><p>如果您安装了 VPython，您还可以拥有 traceroute 的 3D 表示。 右键可以旋转场景，中键可以缩放，左键可以移动场景。 如果你点击一个球，它的 IP 就会出现/消失。 如果您按住 Ctrl 键单击一个球，则会扫描端口 21、22、23、25、80 和 443 并显示结果：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>trace3D<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/school/assets/scapy-6.b390bcd6.png" alt="image"><img src="/school/assets/scapy-7.ed57cbd0.png" alt="image"></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/devdiv/school/edit/master/docs/dev/python/module/scrapy.md" rel="noopener noreferrer" target="_blank" aria-label="在线编辑文档"><!--[--><!--]--> 在线编辑文档 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 837811650@qq,com">devdiv</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/school/dev/python/module/pyshark.html" class="" aria-label="pyshark网络数据包解析"><!--[--><!--]--> pyshark网络数据包解析 <!--[--><!--]--></a></span><span class="next"><a href="/school/dev/python/module/subprocess.html" class="" aria-label="subprocess"><!--[--><!--]--> subprocess <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/school/assets/app.a770902d.js" defer></script>
  </body>
</html>
