<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.32">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"><link rel="icon" href="images/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#ffffff"><meta name="google-site-verification"><title>pyshark网络数据包解析 | School</title><meta name="description" content="不抛弃，不放弃">
    <link rel="modulepreload" href="/school/assets/app.a770902d.js"><link rel="modulepreload" href="/school/assets/pyshark.html.e3889eb8.js"><link rel="modulepreload" href="/school/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/school/assets/pyshark.html.7c6bb988.js">
    <link rel="stylesheet" href="/school/assets/style.b355fc9d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/school/" class=""><img class="logo" src="/school/images/hero.png" alt="School"><span class="site-name can-hide">School</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/school/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络"><span class="title">网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络"><span class="title">网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>数据通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/dc/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/dc/trans/" class="" aria-label="数据传输"><!--[--><!--]--> 数据传输 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>TCP/IP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/netlayer/" class="" aria-label="网络层"><!--[--><!--]--> 网络层 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/translayer/" class="" aria-label="传输层"><!--[--><!--]--> 传输层 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络技术</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tech/lan/" class="" aria-label="局域网"><!--[--><!--]--> 局域网 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tech/eth/" class="" aria-label="以太网交换技术"><!--[--><!--]--> 以太网交换技术 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络安全</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/sec/firewall/" class="" aria-label="防火墙"><!--[--><!--]--> 防火墙 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="研发"><span class="title">研发</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="研发"><span class="title">研发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/python/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/python/module/" class="router-link-active" aria-label="模块"><!--[--><!--]--> 模块 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>测试</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="Vuetify"><!--[--><!--]--> Vuetify <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="管理"><span class="title">管理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="管理"><span class="title">管理</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="过程组"><!--[--><!--]--> 过程组 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="知识域"><!--[--><!--]--> 知识域 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具"><span class="title">工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具"><span class="title">工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/net/netwox/" class="" aria-label="NetWox"><!--[--><!--]--> NetWox <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/net/wireshark/" class="" aria-label="WireShark"><!--[--><!--]--> WireShark <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>研发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/git/" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/yum/" class="" aria-label="Yum"><!--[--><!--]--> Yum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/github/" class="" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/vscode/" class="" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="更多"><span class="title">更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="更多"><span class="title">更多</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/school/more/website.html" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/school/more/reading/" class="" aria-label="读书"><!--[--><!--]--> 读书 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/school/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络"><span class="title">网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络"><span class="title">网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>数据通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/dc/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/dc/trans/" class="" aria-label="数据传输"><!--[--><!--]--> 数据传输 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>TCP/IP</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/netlayer/" class="" aria-label="网络层"><!--[--><!--]--> 网络层 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tcpip/translayer/" class="" aria-label="传输层"><!--[--><!--]--> 传输层 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络技术</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/tech/lan/" class="" aria-label="局域网"><!--[--><!--]--> 局域网 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/net/tech/eth/" class="" aria-label="以太网交换技术"><!--[--><!--]--> 以太网交换技术 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络安全</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/net/sec/firewall/" class="" aria-label="防火墙"><!--[--><!--]--> 防火墙 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="研发"><span class="title">研发</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="研发"><span class="title">研发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/python/basic/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/python/module/" class="router-link-active" aria-label="模块"><!--[--><!--]--> 模块 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>测试</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="Vuetify"><!--[--><!--]--> Vuetify <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="管理"><span class="title">管理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="管理"><span class="title">管理</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/python/" class="" aria-label="过程组"><!--[--><!--]--> 过程组 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/dev/backend/ruby/" class="" aria-label="知识域"><!--[--><!--]--> 知识域 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具"><span class="title">工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具"><span class="title">工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/net/netwox/" class="" aria-label="NetWox"><!--[--><!--]--> NetWox <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/net/wireshark/" class="" aria-label="WireShark"><!--[--><!--]--> WireShark <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>研发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/git/" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/yum/" class="" aria-label="Yum"><!--[--><!--]--> Yum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/github/" class="" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/school/tools/dev/vscode/" class="" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="更多"><span class="title">更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="更多"><span class="title">更多</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/school/more/website.html" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/school/more/reading/" class="" aria-label="读书"><!--[--><!--]--> 读书 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading active">MODULE <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/school/dev/python/module/" class="router-link-active sidebar-item" aria-label="Python 模块"><!--[--><!--]--> Python 模块 <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/builtin.html" class="sidebar-item" aria-label="常用内建模块"><!--[--><!--]--> 常用内建模块 <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/impacket.html" class="sidebar-item" aria-label="Impacket"><!--[--><!--]--> Impacket <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/paramiko.html" class="sidebar-item" aria-label="Paramiko"><!--[--><!--]--> Paramiko <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="pyshark网络数据包解析"><!--[--><!--]--> pyshark网络数据包解析 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#简介" class="router-link-active router-link-exact-active sidebar-item" aria-label="简介"><!--[--><!--]--> 简介 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装"><!--[--><!--]--> 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#内容处理" class="router-link-active router-link-exact-active sidebar-item" aria-label="内容处理"><!--[--><!--]--> 内容处理 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#filecapture-从文件中读取" class="router-link-active router-link-exact-active sidebar-item" aria-label="FileCapture：从文件中读取"><!--[--><!--]--> FileCapture：从文件中读取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#livecapture-从活动接口读取" class="router-link-active router-link-exact-active sidebar-item" aria-label="LiveCapture：从活动接口读取"><!--[--><!--]--> LiveCapture：从活动接口读取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#liveringcapture-使用环状缓冲区从活动接口读取" class="router-link-active router-link-exact-active sidebar-item" aria-label="LiveRingCapture：使用环状缓冲区从活动接口读取"><!--[--><!--]--> LiveRingCapture：使用环状缓冲区从活动接口读取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#remotecapture-从远程活动接口读取" class="router-link-active router-link-exact-active sidebar-item" aria-label="RemoteCapture：从远程活动接口读取"><!--[--><!--]--> RemoteCapture：从远程活动接口读取 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#过滤包数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="过滤包数据"><!--[--><!--]--> 过滤包数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#访问包数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="访问包数据"><!--[--><!--]--> 访问包数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/school/dev/python/module/pyshark.html#解密数据包" class="router-link-active router-link-exact-active sidebar-item" aria-label="解密数据包"><!--[--><!--]--> 解密数据包 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/school/dev/python/module/scrapy.html" class="sidebar-item" aria-label="Scrapy网络数据处理框架"><!--[--><!--]--> Scrapy网络数据处理框架 <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/subprocess.html" class="sidebar-item" aria-label="subprocess"><!--[--><!--]--> subprocess <!--[--><!--]--></a><!----></li><li><a href="/school/dev/python/module/virtualenv.html" class="sidebar-item" aria-label="virtualenv"><!--[--><!--]--> virtualenv <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="pyshark网络数据包解析" tabindex="-1"><a class="header-anchor" href="#pyshark网络数据包解析" aria-hidden="true">#</a> pyshark网络数据包解析</h1><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><ul><li>PyShark 是利用 tshark 和 dumpcap 进行网络数据包解析的 Python 数据包解析器</li><li>本身并不会解析任何数据包，它只会使用 tshark 功能完成包解析；</li><li>提供从文件中读取（FileCapture）内容、从活动接口读取内容（LiveCapture）、使用环状缓冲区从活动接口读取内容（LiveRingCapture）、从远程活动接口读取内容（RemoteCapture）等方式；</li><li>github 地址：<a href="https://github.com/KimiNewt/pyshark.git" target="_blank" rel="noopener noreferrer">https://github.com/KimiNewt/pyshark.git<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a></li><li>扩展文档：<a href="http://kiminewt.github.io/pyshark/" target="_blank" rel="noopener noreferrer">http://kiminewt.github.io/pyshark/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a></li></ul><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><p>pip 安装：</p><div class="language-batch ext-batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">pip</span> install pyshark</span>
</code></pre></div><p>离线安装：</p><div class="language-batch ext-batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">git</span> clone https://github.com/KimiNewt/pyshark.git</span>
<span class="token command"><span class="token keyword">cd</span> pyshark<span class="token parameter attr-name">/src</span></span>
<span class="token command"><span class="token keyword">python</span> setup.py install</span>
</code></pre></div><h2 id="内容处理" tabindex="-1"><a class="header-anchor" href="#内容处理" aria-hidden="true">#</a> 内容处理</h2><p>Pyshark 具有一些“捕获”对象（Live、Remote、File、InMem）。 这些文件中的每一个都从它们各自的源中读取，然后可以用作迭代器来获取它们的数据包。 每个捕获对象还可以接收各种过滤器，以便只保存一些传入的数据包。</p><h3 id="filecapture-从文件中读取" tabindex="-1"><a class="header-anchor" href="#filecapture-从文件中读取" aria-hidden="true">#</a> FileCapture：从文件中读取</h3><p>示例：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> pyshark
cap <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span><span class="token string">&#39;/tmp/mycapture.cap&#39;</span><span class="token punctuation">)</span>
cap
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>FileCapture <span class="token operator">/</span>tmp<span class="token operator">/</span>mycapture<span class="token punctuation">.</span>cap<span class="token operator">&gt;</span>
<span class="token keyword">print</span> cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
Packet <span class="token punctuation">(</span>Length<span class="token punctuation">:</span> <span class="token number">698</span><span class="token punctuation">)</span>
Layer ETH<span class="token punctuation">:</span>
        Destination<span class="token punctuation">:</span> aa<span class="token punctuation">:</span>bb<span class="token punctuation">:</span>cc<span class="token punctuation">:</span>dd<span class="token punctuation">:</span>ee<span class="token punctuation">:</span>ff
        Source<span class="token punctuation">:</span> <span class="token number">00</span><span class="token punctuation">:</span>de<span class="token punctuation">:</span>ad<span class="token punctuation">:</span>be<span class="token punctuation">:</span>ef<span class="token punctuation">:</span><span class="token number">00</span>
        Type<span class="token punctuation">:</span> IP <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span>
Layer IP<span class="token punctuation">:</span>
        Version<span class="token punctuation">:</span> <span class="token number">4</span>
        Header Length<span class="token punctuation">:</span> <span class="token number">20</span> <span class="token builtin">bytes</span>
        Differentiated Services Field<span class="token punctuation">:</span> <span class="token number">0x00</span> <span class="token punctuation">(</span>DSCP <span class="token number">0x00</span><span class="token punctuation">:</span> Default<span class="token punctuation">;</span> ECN<span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">:</span> Not<span class="token operator">-</span>ECT <span class="token punctuation">(</span>Not ECN<span class="token operator">-</span>Capable Transport<span class="token punctuation">)</span><span class="token punctuation">)</span>
        Total Length<span class="token punctuation">:</span> <span class="token number">684</span>
        Identification<span class="token punctuation">:</span> <span class="token number">0x254f</span> <span class="token punctuation">(</span><span class="token number">9551</span><span class="token punctuation">)</span>
        Flags<span class="token punctuation">:</span> <span class="token number">0x00</span>
        Fragment offset<span class="token punctuation">:</span> <span class="token number">0</span>
        Time to live<span class="token punctuation">:</span> <span class="token number">1</span>
        Protocol<span class="token punctuation">:</span> UDP <span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
        Header checksum<span class="token punctuation">:</span> <span class="token number">0xe148</span> <span class="token punctuation">[</span>correct<span class="token punctuation">]</span>
        Source<span class="token punctuation">:</span> <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span>
        Destination<span class="token punctuation">:</span> <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.2</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>参数说明：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token punctuation">:</span>param keep_packets<span class="token punctuation">:</span> Whether to keep packets after reading them via <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Used to conserve memory when reading
large caps <span class="token punctuation">(</span>can only be used along <span class="token keyword">with</span> the <span class="token string">&quot;lazy&quot;</span> option!<span class="token punctuation">)</span>
<span class="token punctuation">:</span>param input_file<span class="token punctuation">:</span> File path of the capture <span class="token punctuation">(</span>PCAP<span class="token punctuation">,</span> PCAPNG<span class="token punctuation">)</span>
<span class="token punctuation">:</span>param display_filter<span class="token punctuation">:</span> A display <span class="token punctuation">(</span>wireshark<span class="token punctuation">)</span> <span class="token builtin">filter</span> to <span class="token builtin">apply</span> on the cap before reading it<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param only_summaries<span class="token punctuation">:</span> Only produce packet summaries<span class="token punctuation">,</span> much faster but includes very little information<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param decryption_key<span class="token punctuation">:</span> Optional key used to encrypt <span class="token keyword">and</span> decrypt captured traffic<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param encryption_type<span class="token punctuation">:</span> Standard of encryption used <span class="token keyword">in</span> captured traffic <span class="token punctuation">(</span>must be either <span class="token string">&#39;WEP&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;WPA-PWD&#39;</span><span class="token punctuation">,</span> <span class="token keyword">or</span>
<span class="token string">&#39;WPA-PWK&#39;</span><span class="token punctuation">.</span> Defaults to WPA<span class="token operator">-</span>PWK<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param decode_as<span class="token punctuation">:</span> A dictionary of <span class="token punctuation">{</span>decode_criterion_string<span class="token punctuation">:</span> decode_as_protocol<span class="token punctuation">}</span> that are used to tell tshark
to decode protocols <span class="token keyword">in</span> situations it wouldn<span class="token string">&#39;t usually, for instance {&#39;</span>tcp<span class="token punctuation">.</span>port<span class="token operator">==</span><span class="token number">8888</span><span class="token string">&#39;: &#39;</span>http&#39;<span class="token punctuation">}</span> would make
it attempt to decode <span class="token builtin">any</span> port <span class="token number">8888</span> traffic <span class="token keyword">as</span> HTTP<span class="token punctuation">.</span> See tshark documentation <span class="token keyword">for</span> details<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param tshark_path<span class="token punctuation">:</span> Path of the tshark binary
<span class="token punctuation">:</span>param override_prefs<span class="token punctuation">:</span> A dictionary of tshark preferences to override<span class="token punctuation">,</span> <span class="token punctuation">{</span>PREFERENCE_NAME<span class="token punctuation">:</span> PREFERENCE_VALUE<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param disable_protocol<span class="token punctuation">:</span> Tells tshark to remove a dissector <span class="token keyword">for</span> a specific protocol<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param use_json<span class="token punctuation">:</span> Uses tshark <span class="token keyword">in</span> JSON mode <span class="token punctuation">(</span>EXPERIMENTAL<span class="token punctuation">)</span><span class="token punctuation">.</span> It <span class="token keyword">is</span> a good deal faster than XML
but also has less information<span class="token punctuation">.</span> Available <span class="token keyword">from</span> Wireshark <span class="token number">2.2</span><span class="token number">.0</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param output_file<span class="token punctuation">:</span> A string of a <span class="token builtin">file</span> to write every read packet into <span class="token punctuation">(</span>useful when filtering<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param custom_parameters<span class="token punctuation">:</span> A <span class="token builtin">dict</span> of custom parameters to <span class="token keyword">pass</span> to tshark<span class="token punctuation">,</span> i<span class="token punctuation">.</span>e<span class="token punctuation">.</span> <span class="token punctuation">{</span><span class="token string">&quot;--param&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="livecapture-从活动接口读取" tabindex="-1"><a class="header-anchor" href="#livecapture-从活动接口读取" aria-hidden="true">#</a> LiveCapture：从活动接口读取</h3><p>示例：</p><div class="language-python ext-py"><pre class="language-python"><code>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
capture
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>LiveCapture <span class="token punctuation">(</span><span class="token number">5</span> packets<span class="token punctuation">)</span><span class="token operator">&gt;</span>
capture<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>UDP<span class="token operator">/</span>HTTP Packet<span class="token operator">&gt;</span>

<span class="token keyword">for</span> packet <span class="token keyword">in</span> capture<span class="token punctuation">.</span>sniff_continuously<span class="token punctuation">(</span>packet_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> packet
</code></pre></div><p>从实时接口捕获可以通过两种方式完成：使用 sniff() 方法捕获给定数量的数据包（或给定时间），然后从捕获对象中读取数据包作为列表，或者使用 sniff_continously() 方法作为生成器并在每个数据包到达时对其进行处理。 另一种选择是为每个接收到的数据包定义一个回调：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_callback</span><span class="token punctuation">(</span>pkt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> pkt
capture<span class="token punctuation">.</span>apply_on_packets<span class="token punctuation">(</span>print_callback<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><p>如果提供了接口列表，捕获也可以在多个接口上运行，如果没有提供接口，则捕获也可以在所有接口上运行。 它甚至可以使用 RemoteCapture 通过远程接口运行。</p><h3 id="liveringcapture-使用环状缓冲区从活动接口读取" tabindex="-1"><a class="header-anchor" href="#liveringcapture-使用环状缓冲区从活动接口读取" aria-hidden="true">#</a> LiveRingCapture：使用环状缓冲区从活动接口读取</h3><p>示例：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveRingCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture
<span class="token operator">&lt;</span>LiveCapture<span class="token punctuation">(</span><span class="token number">5</span> packets<span class="token punctuation">)</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>UDP<span class="token operator">/</span>HTTPPacket<span class="token operator">&gt;</span>
<span class="token keyword">for</span> packet <span class="token keyword">in</span> capture<span class="token punctuation">.</span>sniff_continuously<span class="token punctuation">(</span>packet_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> packet
</code></pre></div><h3 id="remotecapture-从远程活动接口读取" tabindex="-1"><a class="header-anchor" href="#remotecapture-从远程活动接口读取" aria-hidden="true">#</a> RemoteCapture：从远程活动接口读取</h3><p>示例：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>RemoteCapture<span class="token punctuation">(</span><span class="token string">&#39;192.168.1.101&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture
</code></pre></div><h2 id="过滤包数据" tabindex="-1"><a class="header-anchor" href="#过滤包数据" aria-hidden="true">#</a> 过滤包数据</h2><p>可以使用任何捕获对象来过滤数据包，如下所示：</p><div class="language-python ext-py"><pre class="language-python"><code>filtered_cap <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span>path_to_file<span class="token punctuation">,</span> display_filter<span class="token operator">=</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
filtered_cap2 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">,</span> bpf_filter<span class="token operator">=</span><span class="token string">&#39;tcp port 80&#39;</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>There are two types of filters, BPF filters and display filters. Generally, bpf filters are more limited but are faster while display filters can be used on pretty much any attribute of the packet but are much slower. (Note: there is currently an issue with BPF filters on FileCapture and it is not recommended it be used).</p></blockquote><p>BPF Filters 语法帮助：<a href="https://biot.com/capstats/bpf.html" target="_blank" rel="noopener noreferrer">https://biot.com/capstats/bpf.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a> DisplayFilters 语法帮助 <a href="https://wiki.wireshark.org/DisplayFilters" target="_blank" rel="noopener noreferrer">https://wiki.wireshark.org/DisplayFilters<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span></a></p><h2 id="访问包数据" tabindex="-1"><a class="header-anchor" href="#访问包数据" aria-hidden="true">#</a> 访问包数据</h2><p>我们可以通过多种方式访问数据，Python 包被划分成到了多个层，首先我们需要访问特定的层，然后选择相应的数据区域。</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">[</span><span class="token string">&#39;ip&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dst
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>src
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.100</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>src
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.100</span>
</code></pre></div><p>判断数据包中是否包含某一层，我们可以使用下列命令：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token string">&#39;IP&#39;</span> <span class="token keyword">in</span> packet
<span class="token boolean">True</span>
</code></pre></div><p>如需查看所有的数据区域，可以使用“packet.layer.field_names”属性，例如“packet.ip.field_names”。当然了，我们还可以直接获取到数据区域的原始代码数据以及注释信息：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>showname
Sourceor Destination Address<span class="token punctuation">:</span> <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.10</span> <span class="token punctuation">(</span><span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.10</span><span class="token punctuation">)</span>
<span class="token comment"># Andsome new attributes as well:</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>int_value
<span class="token number">167772170</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>binary_value
<span class="token string">&#39;\n\x00\x00\n&#39;</span>
</code></pre></div><h2 id="解密数据包" tabindex="-1"><a class="header-anchor" href="#解密数据包" aria-hidden="true">#</a> 解密数据包</h2><p>Pyshark 支持自动化解密，支持的加密标准有 WEP、WPA-PWD 和 WPA-PSK，默认为 WPA-PWD：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>cap1 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span><span class="token string">&#39;/tmp/capture1.cap&#39;</span><span class="token punctuation">,</span> decryption_key<span class="token operator">=</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>cap2 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;wi0&#39;</span><span class="token punctuation">,</span> decryption_key<span class="token operator">=</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span>encryption_type<span class="token operator">=</span><span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>除此之外，Pyshark 还支持以元组的形式传递支持的加密标准：</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">.</span>SUPPORTED_ENCRYPTION_STANDARDS
<span class="token punctuation">(</span><span class="token string">&#39;wep&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;wpa-pwd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">.</span>SUPPORTED_ENCRYPTION_STANDARDS
<span class="token punctuation">(</span><span class="token string">&#39;wep&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;wpa-pwd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
</code></pre></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/devdiv/school/edit/master/docs/dev/python/module/pyshark.md" rel="noopener noreferrer" target="_blank" aria-label="在线编辑文档"><!--[--><!--]--> 在线编辑文档 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">在新窗口打开</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 837811650@qq,com">devdiv</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/school/dev/python/module/paramiko.html" class="" aria-label="Paramiko"><!--[--><!--]--> Paramiko <!--[--><!--]--></a></span><span class="next"><a href="/school/dev/python/module/scrapy.html" class="" aria-label="Scrapy网络数据处理框架"><!--[--><!--]--> Scrapy网络数据处理框架 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/school/assets/app.a770902d.js" defer></script>
  </body>
</html>
