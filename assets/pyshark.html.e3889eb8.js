import{r as e,o,c,a as n,b as t,F as u,d as a,e as p}from"./app.a770902d.js";import{_ as r}from"./plugin-vue_export-helper.21dcd24c.js";const l={},i=n("h1",{id:"pyshark\u7F51\u7EDC\u6570\u636E\u5305\u89E3\u6790",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pyshark\u7F51\u7EDC\u6570\u636E\u5305\u89E3\u6790","aria-hidden":"true"},"#"),a(" pyshark\u7F51\u7EDC\u6570\u636E\u5305\u89E3\u6790")],-1),k=n("h2",{id:"\u7B80\u4ECB",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u7B80\u4ECB","aria-hidden":"true"},"#"),a(" \u7B80\u4ECB")],-1),d=n("li",null,"PyShark \u662F\u5229\u7528 tshark \u548C dumpcap \u8FDB\u884C\u7F51\u7EDC\u6570\u636E\u5305\u89E3\u6790\u7684 Python \u6570\u636E\u5305\u89E3\u6790\u5668",-1),h=n("li",null,"\u672C\u8EAB\u5E76\u4E0D\u4F1A\u89E3\u6790\u4EFB\u4F55\u6570\u636E\u5305\uFF0C\u5B83\u53EA\u4F1A\u4F7F\u7528 tshark \u529F\u80FD\u5B8C\u6210\u5305\u89E3\u6790\uFF1B",-1),g=n("li",null,"\u63D0\u4F9B\u4ECE\u6587\u4EF6\u4E2D\u8BFB\u53D6\uFF08FileCapture\uFF09\u5185\u5BB9\u3001\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6\u5185\u5BB9\uFF08LiveCapture\uFF09\u3001\u4F7F\u7528\u73AF\u72B6\u7F13\u51B2\u533A\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6\u5185\u5BB9\uFF08LiveRingCapture\uFF09\u3001\u4ECE\u8FDC\u7A0B\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6\u5185\u5BB9\uFF08RemoteCapture\uFF09\u7B49\u65B9\u5F0F\uFF1B",-1),m=a("github \u5730\u5740\uFF1A"),y={href:"https://github.com/KimiNewt/pyshark.git",target:"_blank",rel:"noopener noreferrer"},b=a("https://github.com/KimiNewt/pyshark.git"),f=a("\u6269\u5C55\u6587\u6863\uFF1A"),_={href:"http://kiminewt.github.io/pyshark/",target:"_blank",rel:"noopener noreferrer"},v=a("http://kiminewt.github.io/pyshark/"),w=p(`<h2 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><p>pip \u5B89\u88C5\uFF1A</p><div class="language-batch ext-batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">pip</span> install pyshark</span>
</code></pre></div><p>\u79BB\u7EBF\u5B89\u88C5\uFF1A</p><div class="language-batch ext-batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">git</span> clone https://github.com/KimiNewt/pyshark.git</span>
<span class="token command"><span class="token keyword">cd</span> pyshark<span class="token parameter attr-name">/src</span></span>
<span class="token command"><span class="token keyword">python</span> setup.py install</span>
</code></pre></div><h2 id="\u5185\u5BB9\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u5185\u5BB9\u5904\u7406" aria-hidden="true">#</a> \u5185\u5BB9\u5904\u7406</h2><p>Pyshark \u5177\u6709\u4E00\u4E9B\u201C\u6355\u83B7\u201D\u5BF9\u8C61\uFF08Live\u3001Remote\u3001File\u3001InMem\uFF09\u3002 \u8FD9\u4E9B\u6587\u4EF6\u4E2D\u7684\u6BCF\u4E00\u4E2A\u90FD\u4ECE\u5B83\u4EEC\u5404\u81EA\u7684\u6E90\u4E2D\u8BFB\u53D6\uFF0C\u7136\u540E\u53EF\u4EE5\u7528\u4F5C\u8FED\u4EE3\u5668\u6765\u83B7\u53D6\u5B83\u4EEC\u7684\u6570\u636E\u5305\u3002 \u6BCF\u4E2A\u6355\u83B7\u5BF9\u8C61\u8FD8\u53EF\u4EE5\u63A5\u6536\u5404\u79CD\u8FC7\u6EE4\u5668\uFF0C\u4EE5\u4FBF\u53EA\u4FDD\u5B58\u4E00\u4E9B\u4F20\u5165\u7684\u6570\u636E\u5305\u3002</p><h3 id="filecapture-\u4ECE\u6587\u4EF6\u4E2D\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#filecapture-\u4ECE\u6587\u4EF6\u4E2D\u8BFB\u53D6" aria-hidden="true">#</a> FileCapture\uFF1A\u4ECE\u6587\u4EF6\u4E2D\u8BFB\u53D6</h3><p>\u793A\u4F8B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> pyshark
cap <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span><span class="token string">&#39;/tmp/mycapture.cap&#39;</span><span class="token punctuation">)</span>
cap
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>FileCapture <span class="token operator">/</span>tmp<span class="token operator">/</span>mycapture<span class="token punctuation">.</span>cap<span class="token operator">&gt;</span>
<span class="token keyword">print</span> cap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
Packet <span class="token punctuation">(</span>Length<span class="token punctuation">:</span> <span class="token number">698</span><span class="token punctuation">)</span>
Layer ETH<span class="token punctuation">:</span>
        Destination<span class="token punctuation">:</span> aa<span class="token punctuation">:</span>bb<span class="token punctuation">:</span>cc<span class="token punctuation">:</span>dd<span class="token punctuation">:</span>ee<span class="token punctuation">:</span>ff
        Source<span class="token punctuation">:</span> <span class="token number">00</span><span class="token punctuation">:</span>de<span class="token punctuation">:</span>ad<span class="token punctuation">:</span>be<span class="token punctuation">:</span>ef<span class="token punctuation">:</span><span class="token number">00</span>
        Type<span class="token punctuation">:</span> IP <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span>
Layer IP<span class="token punctuation">:</span>
        Version<span class="token punctuation">:</span> <span class="token number">4</span>
        Header Length<span class="token punctuation">:</span> <span class="token number">20</span> <span class="token builtin">bytes</span>
        Differentiated Services Field<span class="token punctuation">:</span> <span class="token number">0x00</span> <span class="token punctuation">(</span>DSCP <span class="token number">0x00</span><span class="token punctuation">:</span> Default<span class="token punctuation">;</span> ECN<span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">:</span> Not<span class="token operator">-</span>ECT <span class="token punctuation">(</span>Not ECN<span class="token operator">-</span>Capable Transport<span class="token punctuation">)</span><span class="token punctuation">)</span>
        Total Length<span class="token punctuation">:</span> <span class="token number">684</span>
        Identification<span class="token punctuation">:</span> <span class="token number">0x254f</span> <span class="token punctuation">(</span><span class="token number">9551</span><span class="token punctuation">)</span>
        Flags<span class="token punctuation">:</span> <span class="token number">0x00</span>
        Fragment offset<span class="token punctuation">:</span> <span class="token number">0</span>
        Time to live<span class="token punctuation">:</span> <span class="token number">1</span>
        Protocol<span class="token punctuation">:</span> UDP <span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
        Header checksum<span class="token punctuation">:</span> <span class="token number">0xe148</span> <span class="token punctuation">[</span>correct<span class="token punctuation">]</span>
        Source<span class="token punctuation">:</span> <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span>
        Destination<span class="token punctuation">:</span> <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.2</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>\u53C2\u6570\u8BF4\u660E\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token punctuation">:</span>param keep_packets<span class="token punctuation">:</span> Whether to keep packets after reading them via <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Used to conserve memory when reading
large caps <span class="token punctuation">(</span>can only be used along <span class="token keyword">with</span> the <span class="token string">&quot;lazy&quot;</span> option!<span class="token punctuation">)</span>
<span class="token punctuation">:</span>param input_file<span class="token punctuation">:</span> File path of the capture <span class="token punctuation">(</span>PCAP<span class="token punctuation">,</span> PCAPNG<span class="token punctuation">)</span>
<span class="token punctuation">:</span>param display_filter<span class="token punctuation">:</span> A display <span class="token punctuation">(</span>wireshark<span class="token punctuation">)</span> <span class="token builtin">filter</span> to <span class="token builtin">apply</span> on the cap before reading it<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param only_summaries<span class="token punctuation">:</span> Only produce packet summaries<span class="token punctuation">,</span> much faster but includes very little information<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param decryption_key<span class="token punctuation">:</span> Optional key used to encrypt <span class="token keyword">and</span> decrypt captured traffic<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param encryption_type<span class="token punctuation">:</span> Standard of encryption used <span class="token keyword">in</span> captured traffic <span class="token punctuation">(</span>must be either <span class="token string">&#39;WEP&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;WPA-PWD&#39;</span><span class="token punctuation">,</span> <span class="token keyword">or</span>
<span class="token string">&#39;WPA-PWK&#39;</span><span class="token punctuation">.</span> Defaults to WPA<span class="token operator">-</span>PWK<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param decode_as<span class="token punctuation">:</span> A dictionary of <span class="token punctuation">{</span>decode_criterion_string<span class="token punctuation">:</span> decode_as_protocol<span class="token punctuation">}</span> that are used to tell tshark
to decode protocols <span class="token keyword">in</span> situations it wouldn<span class="token string">&#39;t usually, for instance {&#39;</span>tcp<span class="token punctuation">.</span>port<span class="token operator">==</span><span class="token number">8888</span><span class="token string">&#39;: &#39;</span>http&#39;<span class="token punctuation">}</span> would make
it attempt to decode <span class="token builtin">any</span> port <span class="token number">8888</span> traffic <span class="token keyword">as</span> HTTP<span class="token punctuation">.</span> See tshark documentation <span class="token keyword">for</span> details<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param tshark_path<span class="token punctuation">:</span> Path of the tshark binary
<span class="token punctuation">:</span>param override_prefs<span class="token punctuation">:</span> A dictionary of tshark preferences to override<span class="token punctuation">,</span> <span class="token punctuation">{</span>PREFERENCE_NAME<span class="token punctuation">:</span> PREFERENCE_VALUE<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param disable_protocol<span class="token punctuation">:</span> Tells tshark to remove a dissector <span class="token keyword">for</span> a specific protocol<span class="token punctuation">.</span>
<span class="token punctuation">:</span>param use_json<span class="token punctuation">:</span> Uses tshark <span class="token keyword">in</span> JSON mode <span class="token punctuation">(</span>EXPERIMENTAL<span class="token punctuation">)</span><span class="token punctuation">.</span> It <span class="token keyword">is</span> a good deal faster than XML
but also has less information<span class="token punctuation">.</span> Available <span class="token keyword">from</span> Wireshark <span class="token number">2.2</span><span class="token number">.0</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param output_file<span class="token punctuation">:</span> A string of a <span class="token builtin">file</span> to write every read packet into <span class="token punctuation">(</span>useful when filtering<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token punctuation">:</span>param custom_parameters<span class="token punctuation">:</span> A <span class="token builtin">dict</span> of custom parameters to <span class="token keyword">pass</span> to tshark<span class="token punctuation">,</span> i<span class="token punctuation">.</span>e<span class="token punctuation">.</span> <span class="token punctuation">{</span><span class="token string">&quot;--param&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="livecapture-\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#livecapture-\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" aria-hidden="true">#</a> LiveCapture\uFF1A\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6</h3><p>\u793A\u4F8B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
capture
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>LiveCapture <span class="token punctuation">(</span><span class="token number">5</span> packets<span class="token punctuation">)</span><span class="token operator">&gt;</span>
capture<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>UDP<span class="token operator">/</span>HTTP Packet<span class="token operator">&gt;</span>

<span class="token keyword">for</span> packet <span class="token keyword">in</span> capture<span class="token punctuation">.</span>sniff_continuously<span class="token punctuation">(</span>packet_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> packet
</code></pre></div><p>\u4ECE\u5B9E\u65F6\u63A5\u53E3\u6355\u83B7\u53EF\u4EE5\u901A\u8FC7\u4E24\u79CD\u65B9\u5F0F\u5B8C\u6210\uFF1A\u4F7F\u7528 sniff() \u65B9\u6CD5\u6355\u83B7\u7ED9\u5B9A\u6570\u91CF\u7684\u6570\u636E\u5305\uFF08\u6216\u7ED9\u5B9A\u65F6\u95F4\uFF09\uFF0C\u7136\u540E\u4ECE\u6355\u83B7\u5BF9\u8C61\u4E2D\u8BFB\u53D6\u6570\u636E\u5305\u4F5C\u4E3A\u5217\u8868\uFF0C\u6216\u8005\u4F7F\u7528 sniff_continously() \u65B9\u6CD5\u4F5C\u4E3A\u751F\u6210\u5668\u5E76\u5728\u6BCF\u4E2A\u6570\u636E\u5305\u5230\u8FBE\u65F6\u5BF9\u5176\u8FDB\u884C\u5904\u7406\u3002 \u53E6\u4E00\u79CD\u9009\u62E9\u662F\u4E3A\u6BCF\u4E2A\u63A5\u6536\u5230\u7684\u6570\u636E\u5305\u5B9A\u4E49\u4E00\u4E2A\u56DE\u8C03\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_callback</span><span class="token punctuation">(</span>pkt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> pkt
capture<span class="token punctuation">.</span>apply_on_packets<span class="token punctuation">(</span>print_callback<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><p>\u5982\u679C\u63D0\u4F9B\u4E86\u63A5\u53E3\u5217\u8868\uFF0C\u6355\u83B7\u4E5F\u53EF\u4EE5\u5728\u591A\u4E2A\u63A5\u53E3\u4E0A\u8FD0\u884C\uFF0C\u5982\u679C\u6CA1\u6709\u63D0\u4F9B\u63A5\u53E3\uFF0C\u5219\u6355\u83B7\u4E5F\u53EF\u4EE5\u5728\u6240\u6709\u63A5\u53E3\u4E0A\u8FD0\u884C\u3002 \u5B83\u751A\u81F3\u53EF\u4EE5\u4F7F\u7528 RemoteCapture \u901A\u8FC7\u8FDC\u7A0B\u63A5\u53E3\u8FD0\u884C\u3002</p><h3 id="liveringcapture-\u4F7F\u7528\u73AF\u72B6\u7F13\u51B2\u533A\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#liveringcapture-\u4F7F\u7528\u73AF\u72B6\u7F13\u51B2\u533A\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" aria-hidden="true">#</a> LiveRingCapture\uFF1A\u4F7F\u7528\u73AF\u72B6\u7F13\u51B2\u533A\u4ECE\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6</h3><p>\u793A\u4F8B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveRingCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture
<span class="token operator">&lt;</span>LiveCapture<span class="token punctuation">(</span><span class="token number">5</span> packets<span class="token punctuation">)</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>UDP<span class="token operator">/</span>HTTPPacket<span class="token operator">&gt;</span>
<span class="token keyword">for</span> packet <span class="token keyword">in</span> capture<span class="token punctuation">.</span>sniff_continuously<span class="token punctuation">(</span>packet_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span> <span class="token string">&#39;Just arrived:&#39;</span><span class="token punctuation">,</span> packet
</code></pre></div><h3 id="remotecapture-\u4ECE\u8FDC\u7A0B\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#remotecapture-\u4ECE\u8FDC\u7A0B\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6" aria-hidden="true">#</a> RemoteCapture\uFF1A\u4ECE\u8FDC\u7A0B\u6D3B\u52A8\u63A5\u53E3\u8BFB\u53D6</h3><p>\u793A\u4F8B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>RemoteCapture<span class="token punctuation">(</span><span class="token string">&#39;192.168.1.101&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;eth0&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>capture
</code></pre></div><h2 id="\u8FC7\u6EE4\u5305\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u8FC7\u6EE4\u5305\u6570\u636E" aria-hidden="true">#</a> \u8FC7\u6EE4\u5305\u6570\u636E</h2><p>\u53EF\u4EE5\u4F7F\u7528\u4EFB\u4F55\u6355\u83B7\u5BF9\u8C61\u6765\u8FC7\u6EE4\u6570\u636E\u5305\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code>filtered_cap <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span>path_to_file<span class="token punctuation">,</span> display_filter<span class="token operator">=</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
filtered_cap2 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span><span class="token string">&#39;eth0&#39;</span><span class="token punctuation">,</span> bpf_filter<span class="token operator">=</span><span class="token string">&#39;tcp port 80&#39;</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>There are two types of filters, BPF filters and display filters. Generally, bpf filters are more limited but are faster while display filters can be used on pretty much any attribute of the packet but are much slower. (Note: there is currently an issue with BPF filters on FileCapture and it is not recommended it be used).</p></blockquote>`,28),P=a("BPF Filters \u8BED\u6CD5\u5E2E\u52A9\uFF1A"),x={href:"https://biot.com/capstats/bpf.html",target:"_blank",rel:"noopener noreferrer"},C=a("https://biot.com/capstats/bpf.html"),E=a(" DisplayFilters \u8BED\u6CD5\u5E2E\u52A9 "),F={href:"https://wiki.wireshark.org/DisplayFilters",target:"_blank",rel:"noopener noreferrer"},N=a("https://wiki.wireshark.org/DisplayFilters"),A=p(`<h2 id="\u8BBF\u95EE\u5305\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u8BBF\u95EE\u5305\u6570\u636E" aria-hidden="true">#</a> \u8BBF\u95EE\u5305\u6570\u636E</h2><p>\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u591A\u79CD\u65B9\u5F0F\u8BBF\u95EE\u6570\u636E\uFF0CPython \u5305\u88AB\u5212\u5206\u6210\u5230\u4E86\u591A\u4E2A\u5C42\uFF0C\u9996\u5148\u6211\u4EEC\u9700\u8981\u8BBF\u95EE\u7279\u5B9A\u7684\u5C42\uFF0C\u7136\u540E\u9009\u62E9\u76F8\u5E94\u7684\u6570\u636E\u533A\u57DF\u3002</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">[</span><span class="token string">&#39;ip&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dst
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>src
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.100</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>packet<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>src
<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.100</span>
</code></pre></div><p>\u5224\u65AD\u6570\u636E\u5305\u4E2D\u662F\u5426\u5305\u542B\u67D0\u4E00\u5C42\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u4E0B\u5217\u547D\u4EE4\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token string">&#39;IP&#39;</span> <span class="token keyword">in</span> packet
<span class="token boolean">True</span>
</code></pre></div><p>\u5982\u9700\u67E5\u770B\u6240\u6709\u7684\u6570\u636E\u533A\u57DF\uFF0C\u53EF\u4EE5\u4F7F\u7528\u201Cpacket.layer.field_names\u201D\u5C5E\u6027\uFF0C\u4F8B\u5982\u201Cpacket.ip.field_names\u201D\u3002\u5F53\u7136\u4E86\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u76F4\u63A5\u83B7\u53D6\u5230\u6570\u636E\u533A\u57DF\u7684\u539F\u59CB\u4EE3\u7801\u6570\u636E\u4EE5\u53CA\u6CE8\u91CA\u4FE1\u606F\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>showname
Sourceor Destination Address<span class="token punctuation">:</span> <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.10</span> <span class="token punctuation">(</span><span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.10</span><span class="token punctuation">)</span>
<span class="token comment"># Andsome new attributes as well:</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>int_value
<span class="token number">167772170</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>addr<span class="token punctuation">.</span>binary_value
<span class="token string">&#39;\\n\\x00\\x00\\n&#39;</span>
</code></pre></div><h2 id="\u89E3\u5BC6\u6570\u636E\u5305" tabindex="-1"><a class="header-anchor" href="#\u89E3\u5BC6\u6570\u636E\u5305" aria-hidden="true">#</a> \u89E3\u5BC6\u6570\u636E\u5305</h2><p>Pyshark \u652F\u6301\u81EA\u52A8\u5316\u89E3\u5BC6\uFF0C\u652F\u6301\u7684\u52A0\u5BC6\u6807\u51C6\u6709 WEP\u3001WPA-PWD \u548C WPA-PSK\uFF0C\u9ED8\u8BA4\u4E3A WPA-PWD\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>cap1 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span><span class="token string">&#39;/tmp/capture1.cap&#39;</span><span class="token punctuation">,</span> decryption_key<span class="token operator">=</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>cap2 <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&#39;wi0&#39;</span><span class="token punctuation">,</span> decryption_key<span class="token operator">=</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span>encryption_type<span class="token operator">=</span><span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u9664\u6B64\u4E4B\u5916\uFF0CPyshark \u8FD8\u652F\u6301\u4EE5\u5143\u7EC4\u7684\u5F62\u5F0F\u4F20\u9012\u652F\u6301\u7684\u52A0\u5BC6\u6807\u51C6\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">.</span>SUPPORTED_ENCRYPTION_STANDARDS
<span class="token punctuation">(</span><span class="token string">&#39;wep&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;wpa-pwd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pyshark<span class="token punctuation">.</span>LiveCapture<span class="token punctuation">.</span>SUPPORTED_ENCRYPTION_STANDARDS
<span class="token punctuation">(</span><span class="token string">&#39;wep&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;wpa-pwd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wpa-psk&#39;</span><span class="token punctuation">)</span>
</code></pre></div>`,12);function T(D,L){const s=e("ExternalLinkIcon");return o(),c(u,null,[i,k,n("ul",null,[d,h,g,n("li",null,[m,n("a",y,[b,t(s)])]),n("li",null,[f,n("a",_,[v,t(s)])])]),w,n("p",null,[P,n("a",x,[C,t(s)]),E,n("a",F,[N,t(s)])]),A],64)}var W=r(l,[["render",T]]);export{W as default};
