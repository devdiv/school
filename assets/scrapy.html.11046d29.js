import{r as t,o as e,c as o,a as n,b as p,F as c,d as s,e as r}from"./app.a770902d.js";import{_ as l}from"./plugin-vue_export-helper.21dcd24c.js";var u="/school/assets/scapy-1.8361555a.png",k="/school/assets/scapy-2.a581282c.png",m="/school/assets/scapy-3.73790c8c.png",b="/school/assets/scapy-4.e1ea96b9.png",i="/school/assets/scapy-5.13a6ba10.png",g="/school/assets/scapy-6.b390bcd6.png",d="/school/assets/scapy-7.ed57cbd0.png";const x={},f=n("h1",{id:"scrapy\u7F51\u7EDC\u6570\u636E\u5904\u7406\u6846\u67B6",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#scrapy\u7F51\u7EDC\u6570\u636E\u5904\u7406\u6846\u67B6","aria-hidden":"true"},"#"),s(" Scrapy\u7F51\u7EDC\u6570\u636E\u5904\u7406\u6846\u67B6")],-1),h=n("p",null,"Scapy \u662F\u4E00\u4E2A Python \u7A0B\u5E8F\uFF0C\u5B83\u4F7F\u7528\u6237\u80FD\u591F\u53D1\u9001\u3001\u55C5\u63A2\u3001\u5256\u6790\u548C\u4F2A\u9020\u7F51\u7EDC\u6570\u636E\u5305\u3002 \u6B64\u529F\u80FD\u5141\u8BB8\u6784\u5EFA\u53EF\u4EE5\u63A2\u6D4B\u3001\u626B\u63CF\u6216\u653B\u51FB\u7F51\u7EDC\u7684\u5DE5\u5177\u3002",-1),P=n("p",null,"\u6362\u53E5\u8BDD\u8BF4\uFF0CScapy \u662F\u4E00\u4E2A\u5F3A\u5927\u7684\u4EA4\u4E92\u5F0F\u6570\u636E\u5305\u64CD\u4F5C\u7A0B\u5E8F\u3002 \u5B83\u80FD\u591F\u4F2A\u9020\u6216\u89E3\u7801\u591A\u79CD\u534F\u8BAE\u7684\u6570\u636E\u5305\uFF0C\u901A\u8FC7\u7F51\u7EDC\u53D1\u9001\u5B83\u4EEC\uFF0C\u6355\u83B7\u5B83\u4EEC\uFF0C\u5339\u914D\u8BF7\u6C42\u548C\u56DE\u590D\u7B49\u7B49\u3002 Scapy \u53EF\u4EE5\u8F7B\u677E\u5904\u7406\u5927\u591A\u6570\u7ECF\u5178\u4EFB\u52A1\uFF0C\u4F8B\u5982\u626B\u63CF\u3001\u8DDF\u8E2A\u8DEF\u7531\u3001\u63A2\u6D4B\u3001\u5355\u5143\u6D4B\u8BD5\u3001\u653B\u51FB\u6216\u7F51\u7EDC\u53D1\u73B0\u3002 \u5B83\u53EF\u4EE5\u66FF\u4EE3 hping\u3001arpspoof\u3001arp-sk\u3001arping\u3001p0f \u751A\u81F3 Nmap\u3001tcpdump \u548C tshark \u7684\u67D0\u4E9B\u90E8\u5206\u3002",-1),S=n("p",null,[n("img",{src:u,alt:"image"})],-1),I=n("p",null,"Scapy \u5728\u5927\u591A\u6570\u5176\u4ED6\u5DE5\u5177\u65E0\u6CD5\u5904\u7406\u7684\u8BB8\u591A\u5176\u4ED6\u7279\u5B9A\u4EFB\u52A1\u4E0A\u4E5F\u8868\u73B0\u51FA\u8272\uFF0C\u4F8B\u5982\u53D1\u9001\u65E0\u6548\u5E27\u3001\u6CE8\u5165\u60A8\u81EA\u5DF1\u7684 802.11 \u5E27\u3001\u7EC4\u5408\u6280\u672F\uFF08VLAN \u8DF3\u8DC3 + ARP \u7F13\u5B58\u4E2D\u6BD2\u3001WEP \u52A0\u5BC6\u901A\u9053\u4E0A\u7684 VOIP \u89E3\u7801\uFF0C...... \uFF09\uFF0C \u7B49\u7B49\u3002",-1),y=n("p",null,"\u8FD9\u4E2A\u60F3\u6CD5\u5F88\u7B80\u5355\u3002 Scapy \u4E3B\u8981\u505A\u4E24\u4EF6\u4E8B\uFF1A\u53D1\u9001\u6570\u636E\u5305\u548C\u63A5\u6536\u7B54\u6848\u3002 \u60A8\u5B9A\u4E49\u4E00\u7EC4\u6570\u636E\u5305\uFF0C\u5B83\u53D1\u9001\u5B83\u4EEC\uFF0C\u63A5\u6536\u7B54\u6848\uFF0C\u5C06\u8BF7\u6C42\u4E0E\u7B54\u6848\u5339\u914D\u5E76\u8FD4\u56DE\u6570\u636E\u5305\u5BF9\uFF08\u8BF7\u6C42\uFF0C\u7B54\u6848\uFF09\u5217\u8868\u548C\u672A\u5339\u914D\u6570\u636E\u5305\u5217\u8868\u3002 \u4E0E Nmap \u6216 hping \u7B49\u5DE5\u5177\u76F8\u6BD4\uFF0C\u8FD9\u5177\u6709\u5F88\u5927\u7684\u4F18\u52BF\uFF0C\u5373\u7B54\u6848\u4E0D\u4F1A\u7B80\u5316\u4E3A\uFF08\u6253\u5F00/\u5173\u95ED/\u8FC7\u6EE4\uFF09\uFF0C\u800C\u662F\u6574\u4E2A\u6570\u636E\u5305\u3002",-1),A=n("p",null,"\u5728\u6B64\u4E4B\u4E0A\u53EF\u4EE5\u6784\u5EFA\u66F4\u591A\u9AD8\u7EA7\u529F\u80FD\uFF0C\u4F8B\u5982\uFF0C\u6267\u884C\u8DDF\u8E2A\u8DEF\u7531\u5E76\u56E0\u6B64\u4EC5\u7ED9\u51FA\u8BF7\u6C42\u7684\u8D77\u59CB TTL \u548C\u7B54\u6848\u7684\u6E90 IP \u7684\u529F\u80FD\u3002 \u4E00\u4E2A\u53EF\u4EE5 ping \u6574\u4E2A\u7F51\u7EDC\u5E76\u7ED9\u51FA\u5E94\u7B54\u7684\u673A\u5668\u5217\u8868\u3002 \u4E00\u4E2A\u6267\u884C\u7AEF\u53E3\u626B\u63CF\u5E76\u8FD4\u56DE LaTeX \u62A5\u544A\u7684\u7A0B\u5E8F\u3002",-1),w=n("thead",null,[n("tr",null,[n("th",null,"\u9879\u76EE"),n("th",null,"\u63CF\u8FF0")])],-1),q=n("td",null,"\u5B98\u65B9\u6587\u6863",-1),_={href:"https://scapy.net/",target:"_blank",rel:"noopener noreferrer"},C=s("https://scapy.net/"),T=n("td",null,"GitHub",-1),v={href:"https://github.com/secdev/scapy",target:"_blank",rel:"noopener noreferrer"},L=s("https://github.com/secdev/scapy"),R=r(`<h2 id="\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528" aria-hidden="true">#</a> \u4F7F\u7528</h2><h3 id="stacking-layers" tabindex="-1"><a class="header-anchor" href="#stacking-layers" aria-hidden="true">#</a> Stacking layers</h3><p>/ \u8FD0\u7B97\u7B26\u5DF2\u7528\u4F5C\u4E24\u5C42\u4E4B\u95F4\u7684\u7EC4\u5408\u8FD0\u7B97\u7B26\u3002 \u8FD9\u6837\u505A\u65F6\uFF0C\u4E0B\u5C42\u53EF\u4EE5\u6839\u636E\u4E0A\u5C42\u91CD\u8F7D\u4E00\u4E2A\u6216\u591A\u4E2A\u9ED8\u8BA4\u5B57\u6BB5\u3002 \uFF08\u4F60\u4ECD\u7136\u53EF\u4EE5\u7ED9\u51FA\u4F60\u60F3\u8981\u7684\u503C\uFF09\u3002 \u5B57\u7B26\u4E32\u53EF\u4EE5\u7528\u4F5C\u539F\u59CB\u5C42\u3002</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP <span class="token operator">|</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Ether <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">&quot;GET / HTTP/1.0\\r\\n\\r\\n&quot;</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET / HTTP/1.0\\r\\n\\r\\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>UDP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Ether <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>IP <span class="token operator">|</span><span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>UDP <span class="token operator">|</span><span class="token operator">&lt;</span>UDP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span>proto<span class="token operator">=</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span><span class="token number">55</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP <span class="token operator">|</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><p><img src="`+k+`" alt="image"></p><p>\u53EF\u4EE5\u6784\u5EFA\u6216\u5256\u6790\u6BCF\u4E2A\u6570\u636E\u5305\uFF08\u6CE8\u610F\uFF1A\u5728 Python \u4E2D _\uFF08\u4E0B\u5212\u7EBF\uFF09\u662F\u6700\u65B0\u7ED3\u679C\uFF09</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>raw<span class="token punctuation">(</span>IP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token string">&#39;E\\x00\\x00\\x14\\x00\\x01\\x00\\x00@\\x00|\\xe7\\x7f\\x00\\x00\\x01\\x7f\\x00\\x00\\x01&#39;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>IP<span class="token punctuation">(</span>_<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">20</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span> flags<span class="token operator">=</span> frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>IP
 chksum<span class="token operator">=</span><span class="token number">0x7ce7</span> src<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> dst<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">|</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>Ether<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>IP<span class="token punctuation">(</span>dst<span class="token operator">=</span><span class="token string">&quot;www.slashdot.org&quot;</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">&quot;GET /index.html HTTP/1.0 \\n\\n&quot;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>hexdump<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token number">00</span> <span class="token number">02</span> <span class="token number">15</span> <span class="token number">37</span> A2 <span class="token number">44</span> <span class="token number">00</span> AE F3 <span class="token number">52</span> AA D1 <span class="token number">08</span> <span class="token number">00</span> <span class="token number">45</span> <span class="token number">00</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">.7</span><span class="token punctuation">.</span>D<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>R<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>E<span class="token punctuation">.</span>
<span class="token number">00</span> <span class="token number">43</span> <span class="token number">00</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">40</span> <span class="token number">06</span> <span class="token number">78</span> 3C C0 A8 <span class="token number">05</span> <span class="token number">15</span> <span class="token number">42</span> <span class="token number">23</span>  <span class="token punctuation">.</span>C<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>@<span class="token punctuation">.</span>x<span class="token operator">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>B<span class="token comment">#</span>
FA <span class="token number">97</span> <span class="token number">00</span> <span class="token number">14</span> <span class="token number">00</span> <span class="token number">50</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">50</span> <span class="token number">02</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>P<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>P<span class="token punctuation">.</span>
<span class="token number">20</span> <span class="token number">00</span> BB <span class="token number">39</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">47</span> <span class="token number">45</span> <span class="token number">54</span> <span class="token number">20</span> 2F <span class="token number">69</span> 6E <span class="token number">64</span> <span class="token number">65</span> <span class="token number">78</span>   <span class="token punctuation">.</span><span class="token number">.9</span><span class="token punctuation">.</span><span class="token punctuation">.</span>GET <span class="token operator">/</span>index
2E <span class="token number">68</span> <span class="token number">74</span> 6D 6C <span class="token number">20</span> <span class="token number">48</span> <span class="token number">54</span> <span class="token number">54</span> <span class="token number">50</span> 2F <span class="token number">31</span> 2E <span class="token number">30</span> <span class="token number">20</span> 0A  <span class="token punctuation">.</span>html HTTP<span class="token operator">/</span><span class="token number">1.0</span> <span class="token punctuation">.</span>
0A                                               <span class="token punctuation">.</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b<span class="token operator">=</span>raw<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b
&#39;\\x00\\x02\\x157\\xa2D\\x00\\xae\\xf3R\\xaa\\xd1\\x08\\x00E\\x00\\x00C\\x00\\x01\\x00\\x00@\\x06x<span class="token operator">&lt;</span>\\xc0
 \\xa8\\x05\\x15B<span class="token comment">#\\xfa\\x97\\x00\\x14\\x00P\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00P\\x02 \\x00</span>
 \\xbb9\\x00\\x00GET <span class="token operator">/</span>index<span class="token punctuation">.</span>html HTTP<span class="token operator">/</span><span class="token number">1.0</span> \\n\\n&#39;
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c<span class="token operator">=</span>Ether<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span> src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">67</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span> flags<span class="token operator">=</span> frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0x783c</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP sport<span class="token operator">=</span><span class="token number">20</span> dport<span class="token operator">=</span><span class="token number">80</span> seq<span class="token operator">=</span>0L
 ack<span class="token operator">=</span>0L dataofs<span class="token operator">=</span>5L reserved<span class="token operator">=</span>0L flags<span class="token operator">=</span>S window<span class="token operator">=</span><span class="token number">8192</span> chksum<span class="token operator">=</span><span class="token number">0xbb39</span> urgptr<span class="token operator">=</span><span class="token number">0</span>
 options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET /index.html HTTP/1.0 \\n\\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><p>\u5982\u679C\u8FD9\u592A\u5197\u957F\uFF0C\u65B9\u6CD5 hide_defaults() \u5C06\u5220\u9664\u4E0E\u9ED8\u8BA4\u503C\u5177\u6709\u76F8\u540C\u503C\u7684\u6BCF\u4E2A\u5B57\u6BB5\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c<span class="token punctuation">.</span>hide_defaults<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>c
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>0f<span class="token punctuation">:</span><span class="token number">66</span><span class="token punctuation">:</span><span class="token number">56</span><span class="token punctuation">:</span>fa<span class="token punctuation">:</span>d2 src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP ihl<span class="token operator">=</span>5L <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">67</span>
 frag<span class="token operator">=</span><span class="token number">0</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0x783c</span> src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP dataofs<span class="token operator">=</span>5L
 chksum<span class="token operator">=</span><span class="token number">0xbb39</span> options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span><span class="token string">&#39;GET /index.html HTTP/1.0 \\n\\n&#39;</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><h3 id="reading-pcap-files" tabindex="-1"><a class="header-anchor" href="#reading-pcap-files" aria-hidden="true">#</a> Reading PCAP files</h3><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>rdpcap<span class="token punctuation">(</span><span class="token string">&quot;/spare/captures/isakmp.cap&quot;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a
<span class="token operator">&lt;</span>isakmp<span class="token punctuation">.</span>cap<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">721</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">0</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="graphical-dumps-pdf-ps" tabindex="-1"><a class="header-anchor" href="#graphical-dumps-pdf-ps" aria-hidden="true">#</a> Graphical dumps (PDF, PS)</h3><p>\u5982\u679C\u60A8\u5B89\u88C5\u4E86 PyX\uFF0C\u60A8\u53EF\u4EE5\u5236\u4F5C\u4E00\u4E2A\u6570\u636E\u5305\u6216\u6570\u636E\u5305\u5217\u8868\u7684\u56FE\u5F62 PostScript/PDF \u8F6C\u50A8\uFF08\u53C2\u89C1\u4E0B\u9762\u4E11\u964B\u7684 PNG \u56FE\u50CF\u3002PostScript/PDF \u8D28\u91CF\u8981\u597D\u5F97\u591A\u2026\u2026\uFF09\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">[</span><span class="token number">423</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pdfdump<span class="token punctuation">(</span>layer_shift<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">[</span><span class="token number">423</span><span class="token punctuation">]</span><span class="token punctuation">.</span>psdump<span class="token punctuation">(</span><span class="token string">&quot;/tmp/isakmp_pkt.eps&quot;</span><span class="token punctuation">,</span>layer_shift<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="`+m+`" alt="image"></p><h3 id="sniffing" tabindex="-1"><a class="header-anchor" href="#sniffing" aria-hidden="true">#</a> Sniffing</h3><p>\u6211\u4EEC\u53EF\u4EE5\u8F7B\u677E\u6355\u83B7\u4E00\u4E9B\u6570\u636E\u5305\uFF0C\u751A\u81F3\u53EF\u4EE5\u514B\u9686 tcpdump \u6216 tshark\u3002 \u53EF\u4EE5\u63D0\u4F9B\u4E00\u4E2A\u63A5\u53E3\u6216\u8981\u55C5\u63A2\u7684\u63A5\u53E3\u5217\u8868\u3002 \u5982\u679C\u6CA1\u6709\u7ED9\u51FA\u63A5\u53E3\uFF0C\u5219\u4F1A\u5728 <code>conf.iface</code> \u4E0A\u8FDB\u884C\u55C5\u63A2\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token operator">=</span><span class="token string">&quot;icmp and host 66.35.250.151&quot;</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Sniffed<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">2</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>_
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">.</span>nsummary<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">0000</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token number">0001</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
 a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1 src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">84</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">0</span> flags<span class="token operator">=</span>DF frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>ICMP chksum<span class="token operator">=</span><span class="token number">0x3831</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> dst<span class="token operator">=</span><span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>ICMP <span class="token builtin">type</span><span class="token operator">=</span>echo<span class="token operator">-</span>request code<span class="token operator">=</span><span class="token number">0</span>
 chksum<span class="token operator">=</span><span class="token number">0x6571</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">0x8745</span> seq<span class="token operator">=</span><span class="token number">0x0</span> <span class="token operator">|</span><span class="token operator">&lt;</span>Raw load<span class="token operator">=</span>&#39;B\\xf7g\\xda\\x00\\x07um\\x08\\t\\n\\x0b
 \\x0c\\r\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d
 \\x1e\\x1f !\\x22<span class="token comment">#$%&amp;\\&#39;()*+,-./01234567&#39; |&gt;&gt;&gt;&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">&quot;wifi0&quot;</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">5</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Probe Response <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">4</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Probe Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">:</span>d6<span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">:</span>3f <span class="token operator">/</span> <span class="token number">802.11</span> Authentication
<span class="token number">802.11</span> Management <span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Authentication
<span class="token number">802.11</span> Management <span class="token number">0</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">:</span>d6<span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">:</span>3f <span class="token operator">/</span> <span class="token number">802.11</span> Association Request <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info <span class="token number">133</span> <span class="token operator">/</span> Info <span class="token number">149</span>
<span class="token number">802.11</span> Management <span class="token number">1</span> <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">:</span>ee<span class="token punctuation">:</span>a5<span class="token punctuation">:</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">802.11</span> Association Response <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info <span class="token number">133</span> <span class="token operator">/</span> Info <span class="token number">149</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> Management <span class="token number">8</span> ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>ff <span class="token operator">/</span> <span class="token number">802.11</span> Beacon <span class="token operator">/</span> Info SSID <span class="token operator">/</span> Info Rates <span class="token operator">/</span> Info DSset <span class="token operator">/</span> Info TIM <span class="token operator">/</span> Info <span class="token number">133</span>
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> ARP who has <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.172</span> says <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.171</span> <span class="token operator">/</span> Padding
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> ARP <span class="token keyword">is</span> at <span class="token number">00</span><span class="token punctuation">:</span>0a<span class="token punctuation">:</span>b7<span class="token punctuation">:</span>4b<span class="token punctuation">:</span>9c<span class="token punctuation">:</span>dd says <span class="token number">172.20</span><span class="token number">.70</span><span class="token number">.172</span> <span class="token operator">/</span> Padding
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token number">802.11</span> <span class="token operator">/</span> LLC <span class="token operator">/</span> SNAP <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token string">&quot;eth1&quot;</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Ethernet <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
dst       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1
src       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span>
<span class="token builtin">type</span>      <span class="token operator">=</span> <span class="token number">0x800</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> IP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
   version   <span class="token operator">=</span> 4L
   ihl       <span class="token operator">=</span> 5L
   tos       <span class="token operator">=</span> <span class="token number">0x0</span>
   <span class="token builtin">len</span>       <span class="token operator">=</span> <span class="token number">84</span>
   <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0</span>
   flags     <span class="token operator">=</span> DF
   frag      <span class="token operator">=</span> 0L
   ttl       <span class="token operator">=</span> <span class="token number">64</span>
   proto     <span class="token operator">=</span> ICMP
   chksum    <span class="token operator">=</span> <span class="token number">0x3831</span>
   src       <span class="token operator">=</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span>
   dst       <span class="token operator">=</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span>
   options   <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> ICMP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
      <span class="token builtin">type</span>      <span class="token operator">=</span> echo<span class="token operator">-</span>request
      code      <span class="token operator">=</span> <span class="token number">0</span>
      chksum    <span class="token operator">=</span> <span class="token number">0x89d9</span>
      <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0xc245</span>
      seq       <span class="token operator">=</span> <span class="token number">0x0</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Raw <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
         load      <span class="token operator">=</span> <span class="token string">&#39;B\\xf7i\\xa9\\x00\\x04\\x149\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f !\\x22#$%&amp;\\&#39;()*+,-./01234567&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Ethernet <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
dst       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>a2<span class="token punctuation">:</span><span class="token number">44</span>
src       <span class="token operator">=</span> <span class="token number">00</span><span class="token punctuation">:</span>ae<span class="token punctuation">:</span>f3<span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span>aa<span class="token punctuation">:</span>d1
<span class="token builtin">type</span>      <span class="token operator">=</span> <span class="token number">0x800</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> IP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
   version   <span class="token operator">=</span> 4L
   ihl       <span class="token operator">=</span> 5L
   tos       <span class="token operator">=</span> <span class="token number">0x0</span>
   <span class="token builtin">len</span>       <span class="token operator">=</span> <span class="token number">84</span>
   <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">2070</span>
   flags     <span class="token operator">=</span>
   frag      <span class="token operator">=</span> 0L
   ttl       <span class="token operator">=</span> <span class="token number">42</span>
   proto     <span class="token operator">=</span> ICMP
   chksum    <span class="token operator">=</span> <span class="token number">0x861b</span>
   src       <span class="token operator">=</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span>
   dst       <span class="token operator">=</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span>
   options   <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> ICMP <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
      <span class="token builtin">type</span>      <span class="token operator">=</span> echo<span class="token operator">-</span>reply
      code      <span class="token operator">=</span> <span class="token number">0</span>
      chksum    <span class="token operator">=</span> <span class="token number">0x91d9</span>
      <span class="token builtin">id</span>        <span class="token operator">=</span> <span class="token number">0xc245</span>
      seq       <span class="token operator">=</span> <span class="token number">0x0</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Raw <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
         load      <span class="token operator">=</span> <span class="token string">&#39;B\\xf7i\\xa9\\x00\\x04\\x149\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f !\\x22#$%&amp;\\&#39;()*+,-./01234567&#39;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">[</span> Padding <span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
            load      <span class="token operator">=</span> <span class="token string">&#39;\\n_\\x00\\x0b&#39;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;eth1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;eth2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>sniffed_on<span class="token operator">+</span><span class="token string">&quot;: &quot;</span><span class="token operator">+</span>x<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
eth3<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> <span class="token operator">&gt;</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
eth3<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.151</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.21</span> echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
eth2<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.22</span> <span class="token operator">&gt;</span> <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.152</span> echo<span class="token operator">-</span>request <span class="token number">0</span> <span class="token operator">/</span> Raw
eth2<span class="token punctuation">:</span> Ether <span class="token operator">/</span> IP <span class="token operator">/</span> ICMP <span class="token number">66.35</span><span class="token number">.250</span><span class="token number">.152</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.5</span><span class="token number">.22</span> echo<span class="token operator">-</span>reply <span class="token number">0</span> <span class="token operator">/</span> Raw
</code></pre></div><p>\u4E3A\u4E86\u66F4\u597D\u5730\u63A7\u5236\u663E\u793A\u7684\u4FE1\u606F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 <code>sprintf()</code> \u51FD\u6570\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>pkts <span class="token operator">=</span> sniff<span class="token punctuation">(</span>prn<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">.</span>sprintf<span class="token punctuation">(</span><span class="token string">&quot;{IP:%IP.src% -&gt; %IP.dst%\\n}{Raw:%Raw.load%\\n}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>

<span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span>

<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>

<span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>
&#39;GET <span class="token operator">/</span> HTTP<span class="token operator">/</span><span class="token number">1.1</span>\\r\\nHost<span class="token punctuation">:</span> <span class="token number">64.233</span><span class="token number">.167</span><span class="token number">.99</span>\\r\\nUser<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span>
<span class="token punctuation">(</span>X11<span class="token punctuation">;</span> U<span class="token punctuation">;</span> Linux i686<span class="token punctuation">;</span> en<span class="token operator">-</span>US<span class="token punctuation">;</span> rv<span class="token punctuation">:</span><span class="token number">1.8</span><span class="token number">.1</span><span class="token number">.8</span><span class="token punctuation">)</span> Gecko<span class="token operator">/</span><span class="token number">20071022</span> Ubuntu<span class="token operator">/</span><span class="token number">7.10</span> <span class="token punctuation">(</span>gutsy<span class="token punctuation">)</span>
Firefox<span class="token operator">/</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token number">.8</span>\\r\\nAccept<span class="token punctuation">:</span> text<span class="token operator">/</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>
text<span class="token operator">/</span>html<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>text<span class="token operator">/</span>plain<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>image<span class="token operator">/</span>png<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.5</span>\\r\\nAccept<span class="token operator">-</span>Language<span class="token punctuation">:</span>
en<span class="token operator">-</span>us<span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.5</span>\\r\\nAccept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span>deflate\\r\\nAccept<span class="token operator">-</span>Charset<span class="token punctuation">:</span>
ISO<span class="token operator">-</span><span class="token number">8859</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span>\\r\\nKeep<span class="token operator">-</span>Alive<span class="token punctuation">:</span> <span class="token number">300</span>\\r\\nConnection<span class="token punctuation">:</span>
keep<span class="token operator">-</span>alive\\r\\nCache<span class="token operator">-</span>Control<span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>\\r\\n\\r\\n&#39;
</code></pre></div><p>\u6211\u4EEC\u53EF\u4EE5\u55C5\u63A2\u5E76\u8FDB\u884C\u88AB\u52A8\u64CD\u4F5C\u7CFB\u7EDF\u6307\u7EB9\u8BC6\u522B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p
<span class="token operator">&lt;</span>Ether dst<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span>4b<span class="token punctuation">:</span>b3<span class="token punctuation">:</span>7d<span class="token punctuation">:</span>4e src<span class="token operator">=</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">:</span>7b<span class="token punctuation">:</span><span class="token number">60</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0x800</span> <span class="token operator">|</span><span class="token operator">&lt;</span>IP version<span class="token operator">=</span>4L
 ihl<span class="token operator">=</span>5L tos<span class="token operator">=</span><span class="token number">0x0</span> <span class="token builtin">len</span><span class="token operator">=</span><span class="token number">60</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">61681</span> flags<span class="token operator">=</span>DF frag<span class="token operator">=</span>0L ttl<span class="token operator">=</span><span class="token number">64</span> proto<span class="token operator">=</span>TCP chksum<span class="token operator">=</span><span class="token number">0xb85e</span>
 src<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.10</span> dst<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span> options<span class="token operator">=</span><span class="token string">&#39;&#39;</span> <span class="token operator">|</span><span class="token operator">&lt;</span>TCP sport<span class="token operator">=</span><span class="token number">46511</span> dport<span class="token operator">=</span><span class="token number">80</span>
 seq<span class="token operator">=</span>2023566040L ack<span class="token operator">=</span>0L dataofs<span class="token operator">=</span>10L reserved<span class="token operator">=</span>0L flags<span class="token operator">=</span>SEC window<span class="token operator">=</span><span class="token number">5840</span>
 chksum<span class="token operator">=</span><span class="token number">0x570c</span> urgptr<span class="token operator">=</span><span class="token number">0</span> options<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;Timestamp&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>342940201L<span class="token punctuation">,</span> 0L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;MSS&#39;</span><span class="token punctuation">,</span> <span class="token number">1460</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">&#39;NOP&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;SAckOK&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;WScale&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>load_module<span class="token punctuation">(</span><span class="token string">&quot;p0f&quot;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>p0f<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>sniff<span class="token punctuation">(</span>prn<span class="token operator">=</span>prnp0f<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">0.875</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Linux 2.4.2 - 2.4.14 (1)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Linux 2.4.10 (1)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Windows 98 (?)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Windows 2000 (9)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="matplotlib" tabindex="-1"><a class="header-anchor" href="#matplotlib" aria-hidden="true">#</a> Matplotlib</h3><p>222 / 5,000 \u7FFB\u8BD1\u7ED3\u679C \u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 Matplotlib \u8F7B\u677E\u7ED8\u5236\u4E00\u4E9B\u6709\u6548\u7684\u503C\u3002 \uFF08\u786E\u4FDD\u60A8\u5B89\u88C5\u4E86 matplotlib\uFF09\u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u89C2\u5BDF IP ID \u6A21\u5F0F\u4EE5\u4E86\u89E3\u8D1F\u8F7D\u5747\u8861\u5668\u540E\u9762\u4F7F\u7528\u4E86\u591A\u5C11\u4E0D\u540C\u7684 IP \u5806\u6808\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">,</span> b <span class="token operator">=</span> sr<span class="token punctuation">(</span>IP<span class="token punctuation">(</span>dst<span class="token operator">=</span><span class="token string">&quot;www.target.com&quot;</span><span class="token punctuation">)</span><span class="token operator">/</span>TCP<span class="token punctuation">(</span>sport<span class="token operator">=</span><span class="token punctuation">[</span>RandShort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>matplotlib<span class="token punctuation">.</span>lines<span class="token punctuation">.</span>Line2D at <span class="token number">0x2367b80d6a0</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><p><img src="`+b+`" alt="image"></p><h3 id="tcp-traceroute" tabindex="-1"><a class="header-anchor" href="#tcp-traceroute" aria-hidden="true">#</a> TCP traceroute</h3><p>Scapy \u8FD8\u5177\u6709\u5F3A\u5927\u7684 TCP traceroute \u529F\u80FD\u3002 \u4E0E\u5176\u4ED6 traceroute \u7A0B\u5E8F\u5728\u8FDB\u5165\u4E0B\u4E00\u4E2A\u8282\u70B9\u4E4B\u524D\u7B49\u5F85\u6BCF\u4E2A\u8282\u70B9\u56DE\u590D\u4E0D\u540C\uFF0CScapy \u540C\u65F6\u53D1\u9001\u6240\u6709\u6570\u636E\u5305\u3002 \u8FD9\u6837\u505A\u7684\u7F3A\u70B9\u662F\u4E0D\u77E5\u9053\u4EC0\u4E48\u65F6\u5019\u505C\u6B62\uFF08\u56E0\u6B64\u662F maxttl \u53C2\u6570\uFF09\uFF0C\u4F46\u6700\u5927\u7684\u4F18\u70B9\u662F\u4E0D\u5230 3 \u79D2\u5C31\u53EF\u4EE5\u5F97\u5230\u8FD9\u4E2A\u591A\u76EE\u6807 traceroute \u7ED3\u679C\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.yahoo.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.altavista.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.wisenut.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.copernic.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
Received <span class="token number">80</span> packets<span class="token punctuation">,</span> got <span class="token number">80</span> answers<span class="token punctuation">,</span> remaining <span class="token number">0</span> packets
   <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>       <span class="token number">82.243</span><span class="token number">.5</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>
<span class="token number">6</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">213.228</span><span class="token number">.3</span><span class="token number">.234</span>      <span class="token number">193.251</span><span class="token number">.251</span><span class="token number">.69</span>
<span class="token number">7</span>  <span class="token number">213.248</span><span class="token number">.71</span><span class="token number">.141</span>     <span class="token number">217.118</span><span class="token number">.239</span><span class="token number">.149</span>    <span class="token number">208.184</span><span class="token number">.231</span><span class="token number">.214</span>    <span class="token number">193.251</span><span class="token number">.241</span><span class="token number">.178</span>
<span class="token number">8</span>  <span class="token number">213.248</span><span class="token number">.65</span><span class="token number">.81</span>      <span class="token number">217.118</span><span class="token number">.224</span><span class="token number">.44</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.129</span>      <span class="token number">193.251</span><span class="token number">.242</span><span class="token number">.98</span>
<span class="token number">9</span>  <span class="token number">213.248</span><span class="token number">.70</span><span class="token number">.14</span>      <span class="token number">213.206</span><span class="token number">.129</span><span class="token number">.85</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.186</span>      <span class="token number">193.251</span><span class="token number">.243</span><span class="token number">.89</span>
<span class="token number">10</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">213.206</span><span class="token number">.128</span><span class="token number">.160</span>    <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.122</span>      <span class="token number">193.251</span><span class="token number">.254</span><span class="token number">.126</span>
<span class="token number">11</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.169</span><span class="token number">.41</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.70</span>       <span class="token number">216.115</span><span class="token number">.97</span><span class="token number">.178</span>
<span class="token number">12</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.226</span><span class="token number">.99</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.209</span>      <span class="token number">66.218</span><span class="token number">.64</span><span class="token number">.146</span>
<span class="token number">13</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">206.24</span><span class="token number">.227</span><span class="token number">.106</span>     <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.45</span>       <span class="token number">66.218</span><span class="token number">.82</span><span class="token number">.230</span>
<span class="token number">14</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.74</span><span class="token number">.30</span>      <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.214</span>      <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">15</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.120</span><span class="token number">.149</span>    <span class="token number">64.124</span><span class="token number">.229</span><span class="token number">.109</span>     <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">16</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">17</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">18</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">19</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">20</span> <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token punctuation">(</span><span class="token operator">&lt;</span>Traceroute<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">28</span> ICMP<span class="token punctuation">:</span><span class="token number">52</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>Unanswered<span class="token punctuation">:</span> UDP<span class="token punctuation">:</span><span class="token number">0</span> TCP<span class="token punctuation">:</span><span class="token number">0</span> ICMP<span class="token punctuation">:</span><span class="token number">0</span> Other<span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u6700\u540E\u4E00\u884C\u5B9E\u9645\u4E0A\u662F\u51FD\u6570\u7684\u7ED3\u679C\uFF1Atraceroute \u7ED3\u679C\u5BF9\u8C61\u548C\u672A\u5E94\u7B54\u6570\u636E\u5305\u7684\u6570\u636E\u5305\u5217\u8868\u3002 traceroute \u7ED3\u679C\u662F\u7ECF\u5178\u7ED3\u679C\u5BF9\u8C61\u7684\u66F4\u4E13\u4E1A\u5316\u7684\u7248\u672C\uFF08\u5B9E\u9645\u4E0A\u662F\u4E00\u4E2A\u5B50\u7C7B\uFF09\u3002 \u6211\u4EEC\u53EF\u4EE5\u4FDD\u5B58\u5B83\u4EE5\u7A0D\u540E\u518D\u6B21\u67E5\u8BE2 traceroute \u7ED3\u679C\uFF0C\u6216\u8005\u6DF1\u5165\u68C0\u67E5\u5176\u4E2D\u4E00\u4E2A\u7B54\u6848\uFF0C\u4F8B\u5982\u68C0\u67E5\u586B\u5145\u3002</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">,</span> unans <span class="token operator">=</span> _
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">193.45</span><span class="token number">.10</span><span class="token number">.88</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.79</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>result<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> Padding <span class="token keyword">in</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>\u50CF\u4EFB\u4F55\u7ED3\u679C\u5BF9\u8C61\u4E00\u6837\uFF0C\u53EF\u4EE5\u6DFB\u52A0 traceroute \u5BF9\u8C61\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r2<span class="token punctuation">,</span> unans <span class="token operator">=</span> traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.voila.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
Received <span class="token number">19</span> packets<span class="token punctuation">,</span> got <span class="token number">19</span> answers<span class="token punctuation">,</span> remaining <span class="token number">1</span> packets
   <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>
<span class="token number">6</span>  <span class="token number">193.252</span><span class="token number">.161</span><span class="token number">.97</span>
<span class="token number">7</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.86</span>
<span class="token number">8</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.77</span>
<span class="token number">9</span>  <span class="token number">193.252</span><span class="token number">.101</span><span class="token number">.1</span>
<span class="token number">10</span> <span class="token number">193.252</span><span class="token number">.227</span><span class="token number">.245</span>
<span class="token number">12</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">13</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">14</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">15</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">16</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">17</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">18</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">19</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token number">20</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r3<span class="token operator">=</span>result<span class="token operator">+</span>r2
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>r3<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>   <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span><span class="token punctuation">:</span><span class="token number">80</span>    <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span><span class="token punctuation">:</span><span class="token number">80</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>
<span class="token number">4</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.169</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>       <span class="token operator">-</span>                  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.46</span>
<span class="token number">5</span>  <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.162</span>      <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.41</span>       <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.37</span>
<span class="token number">6</span>  <span class="token number">193.252</span><span class="token number">.161</span><span class="token number">.97</span>     <span class="token number">194.68</span><span class="token number">.129</span><span class="token number">.168</span>     <span class="token number">212.27</span><span class="token number">.50</span><span class="token number">.34</span>       <span class="token number">213.228</span><span class="token number">.3</span><span class="token number">.234</span>      <span class="token number">193.251</span><span class="token number">.251</span><span class="token number">.69</span>
<span class="token number">7</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.86</span>     <span class="token number">212.23</span><span class="token number">.42</span><span class="token number">.33</span>       <span class="token number">217.118</span><span class="token number">.239</span><span class="token number">.185</span>    <span class="token number">208.184</span><span class="token number">.231</span><span class="token number">.214</span>    <span class="token number">193.251</span><span class="token number">.241</span><span class="token number">.178</span>
<span class="token number">8</span>  <span class="token number">193.252</span><span class="token number">.103</span><span class="token number">.77</span>     <span class="token number">212.23</span><span class="token number">.42</span><span class="token number">.6</span>        <span class="token number">217.118</span><span class="token number">.224</span><span class="token number">.44</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.129</span>      <span class="token number">193.251</span><span class="token number">.242</span><span class="token number">.98</span>
<span class="token number">9</span>  <span class="token number">193.252</span><span class="token number">.101</span><span class="token number">.1</span>      <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">213.206</span><span class="token number">.129</span><span class="token number">.85</span>     <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.186</span>      <span class="token number">193.251</span><span class="token number">.243</span><span class="token number">.89</span>
<span class="token number">10</span> <span class="token number">193.252</span><span class="token number">.227</span><span class="token number">.245</span>    <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">213.206</span><span class="token number">.128</span><span class="token number">.160</span>    <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.122</span>      <span class="token number">193.251</span><span class="token number">.254</span><span class="token number">.126</span>
<span class="token number">11</span> <span class="token operator">-</span>                  <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.169</span><span class="token number">.41</span>      <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.70</span>       <span class="token number">216.115</span><span class="token number">.97</span><span class="token number">.178</span>
<span class="token number">12</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.226</span><span class="token number">.100</span>     <span class="token number">64.125</span><span class="token number">.28</span><span class="token number">.209</span>      <span class="token number">216.115</span><span class="token number">.101</span><span class="token number">.46</span>
<span class="token number">13</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">206.24</span><span class="token number">.238</span><span class="token number">.166</span>     <span class="token number">64.125</span><span class="token number">.29</span><span class="token number">.45</span>       <span class="token number">66.218</span><span class="token number">.82</span><span class="token number">.234</span>
<span class="token number">14</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.74</span><span class="token number">.30</span>      <span class="token number">64.125</span><span class="token number">.31</span><span class="token number">.214</span>      <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">15</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.120</span><span class="token number">.151</span>    <span class="token number">64.124</span><span class="token number">.229</span><span class="token number">.109</span>     <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">16</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">17</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">18</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">19</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
<span class="token number">20</span> <span class="token number">195.101</span><span class="token number">.94</span><span class="token number">.25</span>   SA <span class="token number">212.23</span><span class="token number">.37</span><span class="token number">.13</span>    SA <span class="token number">216.109</span><span class="token number">.118</span><span class="token number">.72</span>  SA <span class="token number">64.241</span><span class="token number">.242</span><span class="token number">.243</span>  SA <span class="token number">66.94</span><span class="token number">.229</span><span class="token number">.254</span>   SA
</code></pre></div><p>Traceroute \u7ED3\u679C\u5BF9\u8C61\u8FD8\u6709\u4E00\u4E2A\u975E\u5E38\u5DE7\u5999\u7684\u7279\u6027\uFF1A\u5B83\u4EEC\u53EF\u4EE5\u5C06\u5F97\u5230\u7684\u6240\u6709\u8DEF\u7531\u5236\u4F5C\u6210\u6709\u5411\u56FE\uFF0C\u5E76\u901A\u8FC7 AS\uFF08\u81EA\u6CBB\u7CFB\u7EDF\uFF09\u8FDB\u884C\u805A\u7C7B\u3002 \u60A8\u5C06\u9700\u8981graphviz\u3002 \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CImageMagick \u7528\u4E8E\u663E\u793A\u56FE\u5F62\u3002</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">,</span> unans <span class="token operator">=</span> traceroute<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;www.microsoft.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.cisco.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.yahoo.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.wanadoo.fr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;www.pacsec.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dport<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">443</span><span class="token punctuation">]</span><span class="token punctuation">,</span>maxttl<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>retry<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
Received <span class="token number">190</span> packets<span class="token punctuation">,</span> got <span class="token number">190</span> answers<span class="token punctuation">,</span> remaining <span class="token number">10</span> packets
   <span class="token number">193.252</span><span class="token number">.122</span><span class="token number">.103</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token number">193.252</span><span class="token number">.122</span><span class="token number">.103</span><span class="token punctuation">:</span><span class="token number">80</span> <span class="token number">198.133</span><span class="token number">.219</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token number">198.133</span><span class="token number">.219</span><span class="token number">.25</span><span class="token punctuation">:</span><span class="token number">80</span>  <span class="token number">207.46</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">1</span>  <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>         <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.168</span><span class="token number">.8</span><span class="token number">.1</span>        <span class="token number">192.16</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">2</span>  <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>        <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">82.251</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">3</span>  <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>       <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.228</span><span class="token number">.4</span><span class="token number">.254</span>      <span class="token number">213.22</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span><span class="token punctuation">)</span>                          <span class="token comment"># piped to ImageMagick&#39;s display program. Image below.</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;ps&quot;</span><span class="token punctuation">,</span>target<span class="token operator">=</span><span class="token string">&quot;| lp&quot;</span><span class="token punctuation">)</span>   <span class="token comment"># piped to postscript printer</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>graph<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token string">&quot;&gt; /tmp/graph.svg&quot;</span><span class="token punctuation">)</span> <span class="token comment"># saved to file</span>
</code></pre></div><p><img src="`+i+`" alt="image"></p><p>\u5982\u679C\u60A8\u5B89\u88C5\u4E86 VPython\uFF0C\u60A8\u8FD8\u53EF\u4EE5\u62E5\u6709 traceroute \u7684 3D \u8868\u793A\u3002 \u53F3\u952E\u53EF\u4EE5\u65CB\u8F6C\u573A\u666F\uFF0C\u4E2D\u952E\u53EF\u4EE5\u7F29\u653E\uFF0C\u5DE6\u952E\u53EF\u4EE5\u79FB\u52A8\u573A\u666F\u3002 \u5982\u679C\u4F60\u70B9\u51FB\u4E00\u4E2A\u7403\uFF0C\u5B83\u7684 IP \u5C31\u4F1A\u51FA\u73B0/\u6D88\u5931\u3002 \u5982\u679C\u60A8\u6309\u4F4F Ctrl \u952E\u5355\u51FB\u4E00\u4E2A\u7403\uFF0C\u5219\u4F1A\u626B\u63CF\u7AEF\u53E3 21\u300122\u300123\u300125\u300180 \u548C 443 \u5E76\u663E\u793A\u7ED3\u679C\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>res<span class="token punctuation">.</span>trace3D<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="`+g+'" alt="image"><img src="'+d+'" alt="image"></p>',39);function M(E,D){const a=t("ExternalLinkIcon");return e(),o(c,null,[f,h,P,S,I,y,A,n("table",null,[w,n("tbody",null,[n("tr",null,[q,n("td",null,[n("a",_,[C,p(a)])])]),n("tr",null,[T,n("td",null,[n("a",v,[L,p(a)])])])])]),R],64)}var N=l(x,[["render",M]]);export{N as default};
